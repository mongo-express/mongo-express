{
  "openapi": "3.0.0",
  "info": {
    "title": "mongo-express",
    "version": "1.0.0",
    "description": "This Swagger file was generated using OpenAI GPT.",
    "generated_at": "2025-11-21T05:37:10.176673Z",
    "commit_reference": "5e3ff20bb23ea21bb5bff97096747cbdfeba59ee",
    "github_repo_url": "https://github.com/ankitQodex/mongo-express"
  },
  "servers": [
    {
      "url": "https://api.example.com"
    }
  ],
  "paths": {
    "/:database": {
      "delete": {
        "summary": "Delete a Database",
        "api_description": "Deletes a specified MongoDB database. The database name is provided as a path parameter. Only users with proper authentication and authorization can execute this operation. The endpoint enforces CSRF protection and may require either Basic Auth or OIDC-based authentication depending on server configuration. Deleting a database is a destructive action: all collections and documents within the database will be permanently removed. Database names must not be empty, must be fewer than 64 characters, and must not contain any of the following characters: / . \"$*<>:|? .",
        "tags": [
          "Databases"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "required": true,
            "description": "The name of the database to delete. Must be non-empty, fewer than 64 characters, and must not contain /, ., \", $, *, <, >, :, |, or ?.",
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 63,
              "pattern": "^[^/\\.\"\\$\\*<>:|\\?]{1,63}$"
            },
            "example": "my_database"
          },
          {
            "name": "x-csrf-token",
            "in": "header",
            "required": true,
            "description": "CSRF protection token. Required for all non-GET requests.",
            "schema": {
              "type": "string"
            },
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          }
        ],
        "security": [
          {
            "basicAuth": [],
            "oidcAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "databases",
        "sensitive_information": true,
        "responses": {
          "200": {
            "description": "Database deleted successfully. The user will be redirected to the base URL.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Database deleted successfully."
                    },
                    "redirect": {
                      "type": "string",
                      "example": "/"
                    }
                  }
                }
              },
              "text/html": {
                "schema": {
                  "type": "string",
                  "description": "HTML redirect response."
                },
                "example": "<!DOCTYPE html><html><head><meta http-equiv=\"refresh\" content=\"0; URL=/\" /></head><body></body></html>"
              }
            }
          },
          "400": {
            "description": "Invalid database name, or failed to delete database.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "That database name is invalid."
                    }
                  }
                }
              },
              "text/html": {
                "schema": {
                  "type": "string",
                  "description": "HTML error message."
                },
                "example": "<!DOCTYPE html><html><body><h1>Error: That database name is invalid.</h1></body></html>"
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication credentials are missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. The authenticated user does not have permission to delete the database.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Forbidden"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error or failed to delete database.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Failed to delete database. Err: <error details>"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/db/:database/import/:collection": {
      "post": {
        "summary": "Import Documents into a Collection",
        "api_description": "This endpoint allows users to import documents into a specified MongoDB collection within a database. The import is performed via file upload using multipart/form-data. Only files with allowed MIME types (such as application/json and text/csv) are accepted. Each uploaded file must have valid data that can be parsed into documents. If files are missing or invalid, the endpoint responds with an error. The endpoint requires authentication (Basic Auth or OIDC, depending on server configuration) and uses CSRF protection. The operation may modify sensitive data within a database collection.",
        "tags": [
          "Collections"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "The name of the database to import data into.",
            "required": true,
            "schema": {
              "type": "string",
              "example": "mydatabase"
            }
          },
          {
            "name": "collection",
            "in": "path",
            "description": "The name of the collection to import documents into.",
            "required": true,
            "schema": {
              "type": "string",
              "example": "users"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "files": {
                    "type": "array",
                    "description": "Array of files to import. Each file should be in an allowed MIME type (e.g., application/json, text/csv).",
                    "items": {
                      "type": "string",
                      "format": "binary"
                    }
                  }
                },
                "required": [
                  "files"
                ]
              },
              "examples": {
                "importJson": {
                  "summary": "Import JSON File",
                  "value": {
                    "files": [
                      "(binary file: users.json)"
                    ]
                  }
                },
                "importCsv": {
                  "summary": "Import CSV File",
                  "value": {
                    "files": [
                      "(binary file: users.csv)"
                    ]
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "basicAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "collections",
        "sensitive_information": true,
        "responses": {
          "200": {
            "description": "Documents imported successfully into the collection.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Documents imported successfully"
                    },
                    "insertedCount": {
                      "type": "integer",
                      "example": 100,
                      "description": "Number of documents inserted."
                    }
                  }
                },
                "examples": {
                  "success": {
                    "summary": "Successful Import",
                    "value": {
                      "message": "Documents imported successfully",
                      "insertedCount": 100
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Missing or invalid file(s).",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Missing file"
                    }
                  }
                },
                "examples": {
                  "missingFile": {
                    "summary": "No File Uploaded",
                    "value": {
                      "error": "Missing file"
                    }
                  },
                  "badFile": {
                    "summary": "Invalid File Uploaded",
                    "value": {
                      "error": "Bad file"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Authentication is required.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - CSRF token missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid CSRF token"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error - Unexpected error during import.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "An unexpected error occurred"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/": {
      "get": {
        "summary": "Get Homepage",
        "api_description": "This endpoint serves the homepage for the Mongo Express application. It provides general information about the application and, if the user is authenticated and has admin privileges, includes MongoDB server status information. The endpoint is protected by CSRF, session, and (optionally) Basic or OIDC authentication depending on configuration. No request parameters are required. The response is rendered as HTML and includes a CSRF token for subsequent form submissions. This endpoint does not accept query, path, or body parameters.",
        "tags": [
          "Homepages"
        ],
        "parameters": [],
        "responses": {
          "200": {
            "description": "Homepage rendered successfully.",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string",
                  "description": "Rendered HTML of the homepage."
                },
                "examples": {
                  "default": {
                    "summary": "Example homepage HTML",
                    "value": "<!DOCTYPE html>\n<html>\n<head><title>Mongo Express</title></head>\n<body>\n  <h1>Mongo Express</h1>\n  <form method=\"post\">\n    <input type=\"hidden\" name=\"_csrf\" value=\"exampleCsrfToken123\" />\n    <!-- ... -->\n  </form>\n  <!-- If adminDb is defined and admin mode is enabled, serverStatus info may be displayed -->\n</body>\n</html>"
                  }
                }
              },
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "title": {
                      "type": "string",
                      "example": "Mongo Express"
                    },
                    "csrfToken": {
                      "type": "string",
                      "example": "exampleCsrfToken123"
                    },
                    "info": {
                      "oneOf": [
                        {
                          "type": "object",
                          "description": "MongoDB server status info if admin privileges are enabled.",
                          "properties": {
                            "host": {
                              "type": "string",
                              "example": "localhost"
                            },
                            "version": {
                              "type": "string",
                              "example": "4.2.8"
                            },
                            "process": {
                              "type": "string",
                              "example": "mongod"
                            },
                            "uptime": {
                              "type": "number",
                              "example": 123456
                            },
                            "connections": {
                              "type": "object",
                              "properties": {
                                "current": {
                                  "type": "integer",
                                  "example": 5
                                },
                                "available": {
                                  "type": "integer",
                                  "example": 100
                                }
                              }
                            }
                          }
                        },
                        {
                          "type": "boolean",
                          "enum": [
                            false
                          ],
                          "description": "Info is false if admin privileges are not enabled."
                        }
                      ]
                    }
                  }
                },
                "examples": {
                  "adminEnabled": {
                    "summary": "Admin enabled with server status info",
                    "value": {
                      "title": "Mongo Express",
                      "csrfToken": "exampleCsrfToken123",
                      "info": {
                        "host": "localhost",
                        "version": "4.2.8",
                        "process": "mongod",
                        "uptime": 123456,
                        "connections": {
                          "current": 5,
                          "available": 100
                        }
                      }
                    }
                  },
                  "adminDisabled": {
                    "summary": "Admin disabled",
                    "value": {
                      "title": "Mongo Express",
                      "csrfToken": "exampleCsrfToken123",
                      "info": false
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication is required to access the homepage.",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string",
                  "description": "Login page HTML."
                },
                "examples": {
                  "login": {
                    "summary": "Login page example",
                    "value": "<!DOCTYPE html>\n<html>\n<head><title>Login</title></head>\n<body>\n  <form method=\"post\">\n    <input type=\"hidden\" name=\"_csrf\" value=\"exampleCsrfToken123\" />\n    <input type=\"text\" name=\"username\" />\n    <input type=\"password\" name=\"password\" />\n    <button type=\"submit\">Login</button>\n  </form>\n</body>\n</html>"
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. CSRF token missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "invalid csrf token"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Internal Server Error"
                    }
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "basicAuth": [],
            "oidcAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "home",
        "sensitive_information": false
      },
      "post": {
        "summary": "Mongo Express Homepage Login and Connection",
        "api_description": "This endpoint serves as the homepage and handles MongoDB connection setup and login for Mongo Express. If the connection is not yet established, it accepts database connection parameters (hostname, port, username, password, and authentication source) in the request body to initiate a connection. It supports CSRF protection and may require authentication depending on server configuration (Basic Auth or OIDC). If authentication is enabled, credentials are required. The endpoint responds by either redirecting to the main dashboard on success or rendering a login page with error information on failure. Parameter limitations: 'hostname', 'port', 'username', and 'authSource' must be valid strings; 'password' is required except when using a placeholder value.",
        "tags": [
          "Homepages"
        ],
        "requestBody": {
          "required": false,
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "hostname": {
                    "type": "string",
                    "description": "MongoDB server hostname (e.g., 'localhost')."
                  },
                  "port": {
                    "type": "string",
                    "description": "MongoDB server port (e.g., '27017')."
                  },
                  "username": {
                    "type": "string",
                    "description": "Username for MongoDB authentication."
                  },
                  "password": {
                    "type": "string",
                    "description": "Password for MongoDB authentication. If using the placeholder '\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022', the password is not changed."
                  },
                  "authSource": {
                    "type": "string",
                    "description": "Authentication database (e.g., 'admin')."
                  }
                },
                "required": []
              },
              "example": {
                "hostname": "localhost",
                "port": "27017",
                "username": "admin",
                "password": "\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",
                "authSource": "admin"
              }
            }
          }
        },
        "parameters": [
          {
            "in": "header",
            "name": "Authorization",
            "schema": {
              "type": "string"
            },
            "description": "Basic Authentication header. Required if server is configured for Basic Auth.",
            "required": false
          },
          {
            "in": "cookie",
            "name": "connect.sid",
            "schema": {
              "type": "string"
            },
            "description": "Session cookie for maintaining authenticated state.",
            "required": false
          },
          {
            "in": "header",
            "name": "X-CSRF-Token",
            "schema": {
              "type": "string"
            },
            "description": "CSRF token for request validation. Required unless CSRF is disabled or test environment.",
            "required": false
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "homepages",
        "sensitive_information": true,
        "responses": {
          "302": {
            "description": "Redirect to dashboard or previous page. On successful connection and authentication, the user is redirected to the main dashboard. On failure, redirected back to the login page.",
            "headers": {
              "Location": {
                "description": "Redirect URL",
                "schema": {
                  "type": "string",
                  "example": "/"
                }
              }
            },
            "content": {
              "text/html": {
                "schema": {
                  "type": "string",
                  "description": "HTML content for redirection"
                }
              }
            }
          },
          "200": {
            "description": "Renders the login or index page, depending on connection and authentication state.",
            "content": {
              "text/html": {
                "schema": {
                  "type": "string",
                  "description": "HTML content for the login or index page."
                },
                "example": "<html><head><title>Mongo Express</title></head><body>...</body></html>"
              }
            }
          },
          "400": {
            "description": "Bad Request. Invalid parameters or missing required fields.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Missing required field: hostname"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication failed or missing credentials.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid username or password"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. CSRF token missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid CSRF token"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unexpected server error"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/db/:database/reindex/:collection": {
      "get": {
        "summary": "Reindex a Collection",
        "api_description": "This endpoint triggers a reindex operation on a specified MongoDB collection within a given database. It is primarily used to rebuild all indexes on the collection, which can help optimize query performance or resolve index corruption. Only users with valid authentication (Basic Auth or OIDC) can access this endpoint. The endpoint expects the database and collection names as path parameters. If the collection does not support reindexing, an error message is returned. The operation does not return a JSON response; instead, it redirects the user back to the previous page after completion. Note that the endpoint does not accept any query or body parameters.",
        "tags": [
          "Databases"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "The name of the MongoDB database containing the collection to be reindexed.",
            "required": true,
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9_\\-]+$",
              "example": "myDatabase"
            }
          },
          {
            "name": "collection",
            "in": "path",
            "description": "The name of the collection to reindex.",
            "required": true,
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9_\\-]+$",
              "example": "users"
            }
          }
        ],
        "responses": {
          "302": {
            "description": "Redirects back to the previous page after attempting reindex. If successful, a session success message is set. If failed, a session error message is set."
          },
          "400": {
            "description": "Invalid database or collection name supplied.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid collection name."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Authentication failed or user is not authorized.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Database or collection not found.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Collection not found."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error during reindexing.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Error: Index regeneration failed."
                    }
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "basicAuth": [],
            "oidcAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "databases",
        "sensitive_information": false,
        "examples": {
          "request": {
            "method": "GET",
            "path": "/db/myDatabase/reindex/users"
          },
          "success_redirect": {
            "status": 302,
            "headers": {
              "Location": "back"
            }
          },
          "error_response": {
            "status": 400,
            "body": {
              "error": "Invalid collection name."
            }
          }
        }
      }
    },
    "/checkvalid": {
      "post": {
        "summary": "Check Document JSON Validity",
        "api_description": "This endpoint checks whether the provided JSON document is valid and can be parsed and converted to BSON. It expects a JSON or form-urlencoded payload containing the document content as a string and a CSRF token for security. The endpoint returns 'Valid' if the document is valid JSON/BSON, otherwise returns 'Invalid'. This endpoint is typically used before adding or updating documents or indexes to ensure their validity. The 'document' field must be a string representing a JSON object. The '_csrf' field is required for CSRF protection. The endpoint requires authentication and session cookies, and CSRF protection is enforced unless running in a test environment.",
        "tags": [
          "Documents"
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "document": {
                    "type": "string",
                    "description": "A string containing the JSON representation of the document to validate. Must be a valid JSON object."
                  },
                  "_csrf": {
                    "type": "string",
                    "description": "CSRF token required for security."
                  }
                },
                "required": [
                  "document",
                  "_csrf"
                ]
              },
              "example": {
                "document": "{ \"name\": \"John\", \"age\": 30 }",
                "_csrf": "c0f7e9d2-5e2b-4f7e-9c9e-1234567890ab"
              }
            },
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "document": {
                    "type": "string",
                    "description": "A string containing the JSON representation of the document to validate. Must be a valid JSON object."
                  },
                  "_csrf": {
                    "type": "string",
                    "description": "CSRF token required for security."
                  }
                },
                "required": [
                  "document",
                  "_csrf"
                ]
              },
              "example": {
                "document": "{ \"name\": \"John\", \"age\": 30 }",
                "_csrf": "c0f7e9d2-5e2b-4f7e-9c9e-1234567890ab"
              }
            }
          }
        },
        "parameters": [],
        "security": [
          {
            "cookieAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "documents",
        "sensitive_information": false,
        "responses": {
          "200": {
            "description": "Validation result. Returns 'Valid' if the document is a valid JSON/BSON, otherwise 'Invalid'.",
            "content": {
              "text/plain": {
                "schema": {
                  "type": "string",
                  "enum": [
                    "Valid",
                    "Invalid"
                  ],
                  "example": "Valid"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request. The document parameter is missing or not a valid JSON object.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Missing required parameter: document"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication credentials are missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. CSRF token missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid CSRF token"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/db/:database/export/:collection": {
      "get": {
        "summary": "Export Collection Data as JSON",
        "api_description": "Exports documents from a specified collection in a MongoDB database as a downloadable JSON file. The endpoint supports optional query, sort, and projection parameters to filter and shape the exported data. The response is streamed as a JSON file, with the filename matching the collection name. The endpoint requires authentication (Basic Auth or OIDC depending on configuration) and CSRF protection is enforced via cookies. If an error occurs, the user is redirected back and receives an error in their session. Path parameters must be valid MongoDB database and collection names. Query parameters for filtering, sorting, and projection must be valid JSON strings.",
        "tags": [
          "Collections"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9_\\-]+$",
              "description": "Name of the MongoDB database. Must be a valid database name."
            },
            "example": "mydatabase"
          },
          {
            "name": "collection",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9_\\-]+$",
              "description": "Name of the collection to export. Must be a valid collection name."
            },
            "example": "users"
          },
          {
            "name": "query",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "description": "A JSON string specifying the MongoDB query filter. Example: {\"age\": {\"$gte\": 18}}"
            },
            "example": "{\"status\":\"active\"}"
          },
          {
            "name": "sort",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "description": "A JSON string specifying the sort order. Example: {\"createdAt\": -1}"
            },
            "example": "{\"createdAt\":-1}"
          },
          {
            "name": "projection",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "description": "A JSON string specifying the fields to include or exclude. Example: {\"password\": 0}"
            },
            "example": "{\"password\":0,\"email\":1}"
          }
        ],
        "responses": {
          "200": {
            "description": "Collection exported successfully as a downloadable JSON file.",
            "headers": {
              "Content-Disposition": {
                "schema": {
                  "type": "string",
                  "example": "attachment; filename=\"users.json\"; filename*=UTF-8''users.json"
                },
                "description": "Indicates that the response is a file attachment."
              },
              "Content-Type": {
                "schema": {
                  "type": "string",
                  "example": "application/json"
                },
                "description": "The content type of the response."
              }
            },
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "description": "An array of documents from the collection.",
                  "items": {
                    "type": "object",
                    "properties": {
                      "_id": {
                        "type": "string",
                        "description": "Document unique identifier."
                      }
                    },
                    "additionalProperties": true,
                    "example": {
                      "_id": "60f6c2c2e1d3c8a2b3e9f9c1",
                      "username": "alice",
                      "email": "alice@example.com",
                      "age": 30,
                      "createdAt": "2024-06-01T12:00:00.000Z"
                    }
                  }
                },
                "examples": {
                  "default": {
                    "summary": "Exported Collection Documents",
                    "value": [
                      {
                        "_id": "60f6c2c2e1d3c8a2b3e9f9c1",
                        "username": "alice",
                        "email": "alice@example.com",
                        "age": 30,
                        "createdAt": "2024-06-01T12:00:00.000Z"
                      },
                      {
                        "_id": "60f6c2c2e1d3c8a2b3e9f9c2",
                        "username": "bob",
                        "email": "bob@example.com",
                        "age": 25,
                        "createdAt": "2024-06-02T15:30:00.000Z"
                      }
                    ]
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request parameters (e.g., malformed query, sort, or projection).",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid query parameter: Unexpected token } in JSON at position 10"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication is required.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. CSRF token missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid CSRF token"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Database or collection not found.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Collection not found"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error. Database error or export failure.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Failed to export collection: [error message]"
                    }
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "basicAuth": [],
            "cookieAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "collections",
        "sensitive_information": true
      }
    },
    "/db/:database": {
      "get": {
        "summary": "View Database Details",
        "api_description": "Retrieves detailed information about a specific MongoDB database, including collections, GridFS buckets, and (if admin access is enabled) database statistics such as object size, collection count, data size, file version, indexes, and storage size. Requires authentication (Basic Auth and/or OIDC, depending on configuration) and CSRF protection. The database name must be a valid MongoDB database identifier. This endpoint does not accept a request body. The endpoint will return an error if the database does not exist or if the user does not have permission to access it.",
        "tags": [
          "Databases"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "The name of the MongoDB database to view. Must be a valid MongoDB database name (cannot contain null characters, must not be empty, must not include \"/\", \" \", or \".\", and must be less than 64 characters).",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 63,
              "pattern": "^[^\\\\/\\.\\s\\0]+$"
            },
            "example": "mydb"
          },
          {
            "name": "csrf-token",
            "in": "header",
            "description": "CSRF token for request validation. Required unless running in test mode.",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
          }
        ],
        "security": [
          {
            "basicAuth": [],
            "oidcAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "databases",
        "sensitive_information": true,
        "responses": {
          "200": {
            "description": "Database details retrieved successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "title": {
                      "type": "string",
                      "example": "Viewing Database: mydb"
                    },
                    "databases": {
                      "type": "array",
                      "description": "List of available databases.",
                      "items": {
                        "type": "string"
                      },
                      "example": [
                        "admin",
                        "mydb",
                        "test"
                      ]
                    },
                    "colls": {
                      "type": "array",
                      "description": "List of collections in the database.",
                      "items": {
                        "type": "string"
                      },
                      "example": [
                        "users",
                        "orders",
                        "products"
                      ]
                    },
                    "grids": {
                      "type": "array",
                      "description": "List of GridFS buckets in the database.",
                      "items": {
                        "type": "string"
                      },
                      "example": [
                        "fs",
                        "images"
                      ]
                    },
                    "csrfToken": {
                      "type": "string",
                      "description": "CSRF token for subsequent requests.",
                      "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                    },
                    "stats": {
                      "oneOf": [
                        {
                          "type": "object",
                          "description": "Database statistics (if admin access is enabled).",
                          "properties": {
                            "avgObjSize": {
                              "type": "string",
                              "description": "Average object size (human-readable).",
                              "example": "1.5 KB"
                            },
                            "collections": {
                              "type": "integer",
                              "description": "Number of collections in the database.",
                              "example": 5
                            },
                            "dataFileVersion": {
                              "type": [
                                "string",
                                "null"
                              ],
                              "description": "Data file version (major.minor) or null if not available.",
                              "example": "4.2"
                            },
                            "dataSize": {
                              "type": "string",
                              "description": "Total data size (human-readable).",
                              "example": "12.8 MB"
                            },
                            "extentFreeListNum": {
                              "type": [
                                "integer",
                                "null"
                              ],
                              "description": "Number of free extents or null if not available.",
                              "example": 2
                            },
                            "fileSize": {
                              "type": [
                                "string",
                                "null"
                              ],
                              "description": "Total file size (human-readable) or null if not available.",
                              "example": "20.0 MB"
                            },
                            "indexes": {
                              "type": "integer",
                              "description": "Number of indexes in the database.",
                              "example": 12
                            },
                            "indexSize": {
                              "type": "string",
                              "description": "Total index size (human-readable).",
                              "example": "1.2 MB"
                            },
                            "numExtents": {
                              "type": [
                                "string",
                                "null"
                              ],
                              "description": "Number of extents (as string) or null if not available.",
                              "example": "5"
                            },
                            "objects": {
                              "type": "integer",
                              "description": "Number of objects/documents in the database.",
                              "example": 10000
                            },
                            "storageSize": {
                              "type": "string",
                              "description": "Total storage size (human-readable).",
                              "example": "15.0 MB"
                            }
                          }
                        },
                        {
                          "type": "boolean",
                          "enum": [
                            false
                          ],
                          "description": "Statistics not available (if admin access is disabled)."
                        }
                      ]
                    }
                  },
                  "required": [
                    "title",
                    "databases",
                    "colls",
                    "grids",
                    "csrfToken",
                    "stats"
                  ]
                },
                "examples": {
                  "admin-enabled": {
                    "summary": "Admin Access Enabled",
                    "value": {
                      "title": "Viewing Database: mydb",
                      "databases": [
                        "admin",
                        "mydb",
                        "test"
                      ],
                      "colls": [
                        "users",
                        "orders",
                        "products"
                      ],
                      "grids": [
                        "fs"
                      ],
                      "csrfToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
                      "stats": {
                        "avgObjSize": "1.5 KB",
                        "collections": 5,
                        "dataFileVersion": "4.2",
                        "dataSize": "12.8 MB",
                        "extentFreeListNum": 2,
                        "fileSize": "20.0 MB",
                        "indexes": 12,
                        "indexSize": "1.2 MB",
                        "numExtents": "5",
                        "objects": 10000,
                        "storageSize": "15.0 MB"
                      }
                    }
                  },
                  "admin-disabled": {
                    "summary": "Admin Access Disabled",
                    "value": {
                      "title": "Viewing Database: mydb",
                      "databases": [
                        "admin",
                        "mydb",
                        "test"
                      ],
                      "colls": [
                        "users",
                        "orders",
                        "products"
                      ],
                      "grids": [
                        "fs"
                      ],
                      "csrfToken": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
                      "stats": false
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid database name or bad request.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "That database name is invalid."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Authentication required or failed.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required."
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden: User does not have access to the database.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "You do not have permission to view this database."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Database not found.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Database not found."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Could not get stats. {\"message\":\"Internal error\"}"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a New Database",
        "api_description": "This endpoint allows an authenticated user to create a new MongoDB database. The database name must be valid according to MongoDB's naming rules (no empty strings, no spaces, no special characters like $, and must not exceed the allowed length). Upon successful creation, an initial collection named 'delete_me' is created in the new database to trigger the actual creation in MongoDB. If the name is invalid, the request fails. Authentication (Basic Auth or OIDC) and CSRF protection are enforced. Sessions and cookies are used for user state management.",
        "tags": [
          "Databases"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "The name of the database to create. Must be a valid MongoDB database name.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 64,
              "pattern": "^[^\\s\\$\\.\\/\\\\]+$"
            },
            "example": "my_new_database"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "database": {
                    "type": "string",
                    "description": "The name of the database to create. Must be a valid MongoDB database name.",
                    "minLength": 1,
                    "maxLength": 64,
                    "pattern": "^[^\\s\\$\\.\\/\\\\]+$",
                    "example": "my_new_database"
                  }
                },
                "required": [
                  "database"
                ]
              }
            },
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "database": {
                    "type": "string",
                    "description": "The name of the database to create. Must be a valid MongoDB database name.",
                    "minLength": 1,
                    "maxLength": 64,
                    "pattern": "^[^\\s\\$\\.\\/\\\\]+$",
                    "example": "my_new_database"
                  }
                },
                "required": [
                  "database"
                ]
              }
            }
          }
        },
        "security": [
          {
            "basicAuth": [],
            "oidcAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "databases",
        "sensitive_information": true,
        "responses": {
          "302": {
            "description": "Database created successfully. Client is redirected to the base URL or the database view page.",
            "headers": {
              "Location": {
                "description": "URL to redirect the client to after successful creation.",
                "schema": {
                  "type": "string",
                  "example": "/"
                }
              }
            },
            "content": {
              "text/html": {
                "schema": {
                  "type": "string",
                  "example": "<html><head><meta http-equiv=\"refresh\" content=\"0; url=/\" /></head></html>"
                }
              }
            }
          },
          "400": {
            "description": "Invalid database name or could not create collection.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "That database name is invalid."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication credentials are missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required."
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. CSRF token missing or incorrect.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid CSRF token."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error. Could not create the database or collection.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Could not create collection. Err: <error details>"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/db/:database/addindex/:collection": {
      "post": {
        "summary": "Add Index to Collection",
        "api_description": "This endpoint allows an authenticated user to add a new index to a specific collection in a MongoDB database. The user must provide the index definition as a JSON object in the request body under the 'index' field. The endpoint validates the presence and structure of the index, attempts to convert it to BSON, and creates the index on the specified collection. If the index definition is missing, empty, or invalid JSON, the request is rejected. Successful creation results in a redirect to the collection view; errors result in a redirect with an error message. The endpoint requires authentication (Basic Auth or OIDC) and CSRF protection, and is protected by session management.",
        "tags": [
          "Databases"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "The name of the MongoDB database in which the collection exists.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "example": "mydatabase"
            }
          },
          {
            "name": "collection",
            "in": "path",
            "description": "The name of the collection to which the index will be added.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "example": "users"
            }
          },
          {
            "name": "cookie",
            "in": "header",
            "description": "Session cookie for authentication and CSRF protection.",
            "required": true,
            "schema": {
              "type": "string",
              "example": "connect.sid=s%3Aabc123..."
            }
          },
          {
            "name": "x-csrf-token",
            "in": "header",
            "description": "CSRF token for request validation.",
            "required": true,
            "schema": {
              "type": "string",
              "example": "4f8d2f3a-5e1d-4f6c-8e5d-csrf-token"
            }
          },
          {
            "name": "authorization",
            "in": "header",
            "description": "Authorization header, required if Basic Auth or OIDC is enabled. Format: 'Basic base64(username:password)' or Bearer token for OIDC.",
            "required": false,
            "schema": {
              "type": "string",
              "example": "Basic YWRtaW46cGFzcw=="
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "index": {
                    "type": "object",
                    "description": "The index specification as a valid JSON object. Must not be empty. Example: { \"email\": 1 }",
                    "minProperties": 1,
                    "example": {
                      "email": 1
                    }
                  }
                },
                "required": [
                  "index"
                ]
              },
              "examples": {
                "SingleFieldIndex": {
                  "summary": "Single field ascending index",
                  "value": {
                    "index": {
                      "email": 1
                    }
                  }
                },
                "CompoundIndex": {
                  "summary": "Compound index",
                  "value": {
                    "index": {
                      "lastName": 1,
                      "firstName": -1
                    }
                  }
                }
              }
            },
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "index": {
                    "type": "string",
                    "description": "The index specification as a JSON string. Must not be empty. Example: '{\"email\":1}'",
                    "example": "{\"email\":1}"
                  }
                },
                "required": [
                  "index"
                ]
              }
            }
          }
        },
        "authorization_tag": "Authorization Required",
        "module_tag": "databases",
        "sensitive_information": true,
        "responses": {
          "302": {
            "description": "Redirect after index creation or error. On success, redirects to the collection view. On error, redirects back with an error message in the session.",
            "headers": {
              "Location": {
                "description": "URL to redirect to (either the collection view or back).",
                "schema": {
                  "type": "string",
                  "example": "/db/mydatabase/collections/users"
                }
              }
            },
            "content": {
              "text/html": {
                "schema": {
                  "type": "string",
                  "example": "<!DOCTYPE html><html><head><meta http-equiv=\"refresh\" content=\"0;url=/db/mydatabase/collections/users\"></head></html>"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request. The index definition is missing, empty, or not valid JSON.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "You forgot to enter a index!"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication credentials are missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. CSRF token missing or invalid, or insufficient permissions.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid CSRF token"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error. An unexpected error occurred while creating the index.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Something went wrong: Index creation failed"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/db/:database/updatecollections": {
      "get": {
        "summary": "Update Collections in a Database",
        "api_description": "This endpoint triggers a refresh of the collection list for the specified MongoDB database. It updates the server-side cache of collections and redirects the user to the database view. The endpoint requires authentication (either Basic Auth or OIDC, depending on configuration) and a valid session with CSRF protection. The path parameter 'database' must be the name of an existing database. No request body or query parameters are required. On success, the collections are updated and the user is redirected. On failure, an error message is set in the session and the user is redirected back.",
        "tags": [
          "Databases"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "The name of the MongoDB database whose collections should be refreshed. Must be a valid, existing database name.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "example": "mydatabase"
            }
          },
          {
            "name": "cookie",
            "in": "header",
            "description": "Session cookie for authentication. Required if session-based authentication is enabled.",
            "required": true,
            "schema": {
              "type": "string",
              "example": "connect.sid=s%3Aabc123def456"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "description": "Basic authentication header or Bearer token if OIDC is enabled. Format: 'Basic base64(username:password)' or 'Bearer <token>'. Required if authentication is enabled.",
            "required": false,
            "schema": {
              "type": "string",
              "example": "Basic YWRtaW46cGFzcw=="
            }
          },
          {
            "name": "x-csrf-token",
            "in": "header",
            "description": "CSRF token for request validation. Required if CSRF protection is enabled.",
            "required": true,
            "schema": {
              "type": "string",
              "example": "abcde12345"
            }
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "databases",
        "sensitive_information": true,
        "responses": {
          "302": {
            "description": "Redirect to the database view page after successfully updating collections.",
            "headers": {
              "Location": {
                "description": "URL to redirect the client to the database view.",
                "schema": {
                  "type": "string",
                  "example": "/db/mydatabase"
                }
              },
              "Set-Cookie": {
                "description": "Session cookie, may be updated.",
                "schema": {
                  "type": "string",
                  "example": "connect.sid=s%3Aabc123def456"
                }
              }
            },
            "content": {
              "text/html": {
                "schema": {
                  "type": "string",
                  "example": "<!DOCTYPE html><html><head><meta http-equiv=\"refresh\" content=\"0; URL='/db/mydatabase'\" /></head></html>"
                }
              }
            }
          },
          "400": {
            "description": "Bad request due to invalid database name or missing authentication/session.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid database name."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication required or session expired.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required."
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. CSRF token missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid CSRF token."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error. Could not update collections.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Something went wrong: <error details>"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/db/:database/expcsv/:collection": {
      "get": {
        "summary": "Export Collection as CSV",
        "api_description": "This endpoint allows an authenticated user to export a MongoDB collection as a CSV file. The exported CSV contains the documents from the specified collection, filtered and sorted based on optional query parameters. The response is a downloadable CSV file. The endpoint requires authentication (Basic Auth or OIDC depending on server configuration) and CSRF protection. Path parameters 'database' and 'collection' must be valid MongoDB names. Query parameters allow filtering, sorting, and projection, but must be valid JSON strings. If an error occurs (e.g., invalid parameters, authentication failure), the user is redirected back with an error message.",
        "tags": [
          "Databases"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "description": "The name of the MongoDB database. Must be a valid database name as per MongoDB naming conventions.",
              "example": "mydatabase",
              "minLength": 1,
              "pattern": "^[a-zA-Z0-9_.-]+$"
            }
          },
          {
            "name": "collection",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "description": "The name of the collection to export. Must be a valid MongoDB collection name.",
              "example": "users",
              "minLength": 1,
              "pattern": "^[a-zA-Z0-9_.-]+$"
            }
          },
          {
            "name": "query",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "description": "A JSON string representing filter criteria for documents to export.",
              "example": "{\"age\": {\"$gte\": 18}}"
            }
          },
          {
            "name": "sort",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "description": "A JSON string representing the sort order. E.g., '{\"createdAt\": -1}'",
              "example": "{\"createdAt\": -1}"
            }
          },
          {
            "name": "projection",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "description": "A JSON string specifying which fields to include or exclude.",
              "example": "{\"name\": 1, \"email\": 1}"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "CSV file containing the exported collection data.",
            "content": {
              "text/csv": {
                "schema": {
                  "type": "string",
                  "format": "binary",
                  "description": "The CSV file stream."
                },
                "examples": {
                  "csv": {
                    "summary": "Sample exported CSV",
                    "value": "name,email,age\nJohn Doe,john@example.com,28\nJane Roe,jane@example.com,34"
                  }
                }
              }
            },
            "headers": {
              "Content-Disposition": {
                "description": "Indicates that the response is an attachment with a filename.",
                "schema": {
                  "type": "string",
                  "example": "attachment; filename=\"users.csv\"; filename*=UTF-8''users.csv"
                }
              },
              "Content-Type": {
                "description": "The content type of the response.",
                "schema": {
                  "type": "string",
                  "example": "text/csv"
                }
              }
            }
          },
          "400": {
            "description": "Bad request due to invalid parameters (e.g., malformed query, invalid database/collection name).",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid query parameter"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication is required to access this endpoint.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. User is not authorized or CSRF token missing/invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Forbidden: Invalid CSRF token"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Database or collection not found.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Collection not found"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error while exporting the collection.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Internal server error"
                    }
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "basicAuth": [],
            "oidcAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "databases",
        "sensitive_information": true
      }
    },
    "/db/:database/exparr/:collection": {
      "get": {
        "summary": "Export Collection as JSON Array",
        "api_description": "This endpoint exports the specified MongoDB collection as a JSON array. It streams the entire collection or a filtered subset based on optional query parameters. The response is a downloadable JSON file containing the matched documents. The endpoint requires authentication (Basic Auth or OIDC, depending on configuration) and CSRF protection is enforced. The endpoint is intended for administrative/database management use and exposes raw collection data, which may include sensitive content. Limitations: The collection name and database name must be valid MongoDB identifiers; the query, sort, and projection parameters must be valid JSON objects as strings.",
        "tags": [
          "Databases"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Name of the MongoDB database. Must be a valid database identifier."
            },
            "example": "testdb"
          },
          {
            "name": "collection",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "description": "Name of the collection to export. Must be a valid collection identifier."
            },
            "example": "users"
          },
          {
            "name": "query",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "description": "A JSON-encoded string specifying the MongoDB query filter. Only documents matching this filter will be exported."
            },
            "example": "{\"isActive\":true}"
          },
          {
            "name": "sort",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "description": "A JSON-encoded string specifying the sort order for the export."
            },
            "example": "{\"createdAt\":-1}"
          },
          {
            "name": "projection",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "description": "A JSON-encoded string specifying the fields to include or exclude."
            },
            "example": "{\"_id\":0,\"email\":1,\"name\":1}"
          }
        ],
        "responses": {
          "200": {
            "description": "Successful export of the collection as a JSON array. The response is a downloadable JSON file.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "type": "object",
                    "description": "A document from the exported collection.",
                    "example": {
                      "_id": "64f23a8e5f1c2b001fc0d1e2",
                      "name": "Alice",
                      "email": "alice@example.com",
                      "isActive": true,
                      "createdAt": "2024-06-01T10:15:00Z"
                    }
                  }
                },
                "examples": {
                  "ExportedArray": {
                    "summary": "Sample exported collection array",
                    "value": [
                      {
                        "_id": "64f23a8e5f1c2b001fc0d1e2",
                        "name": "Alice",
                        "email": "alice@example.com",
                        "isActive": true,
                        "createdAt": "2024-06-01T10:15:00Z"
                      },
                      {
                        "_id": "64f23a8e5f1c2b001fc0d1e3",
                        "name": "Bob",
                        "email": "bob@example.com",
                        "isActive": false,
                        "createdAt": "2024-05-22T09:00:00Z"
                      }
                    ]
                  }
                }
              }
            },
            "headers": {
              "Content-Disposition": {
                "description": "Indicates the response is an attachment with a filename.",
                "schema": {
                  "type": "string",
                  "example": "attachment; filename=\"users.json\"; filename*=UTF-8''users.json"
                }
              },
              "Content-Type": {
                "description": "The MIME type of the response.",
                "schema": {
                  "type": "string",
                  "example": "application/json"
                }
              }
            }
          },
          "400": {
            "description": "Invalid input: The query, sort, or projection parameters are not valid JSON, or the database/collection names are invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid query parameter: Unexpected token } in JSON"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized: Authentication is required and has failed or has not yet been provided.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden: The authenticated user does not have permission to export this collection.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Access denied"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error or database error occurred during export.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Could not export collection: <error details>"
                    }
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "basicAuth": [],
            "oidc": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "databases",
        "sensitive_information": true
      }
    },
    "/db/:database/compact/:collection": {
      "get": {
        "summary": "Compact a MongoDB Collection",
        "api_description": "This endpoint compacts a specific collection within a given MongoDB database. Compaction rewrites and defragments all data and indexes within the collection, potentially freeing up disk space. The operation is performed using the MongoDB 'compact' command. Only users with sufficient privileges can execute this operation. If successful, the user is redirected back with a success message. On error, the user is redirected back and an error message is set in the session. Path parameters must be valid MongoDB database and collection names. The endpoint requires authentication and session management, and may be protected by Basic Auth or OIDC depending on server configuration.",
        "tags": [
          "Collections"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "The name of the MongoDB database containing the collection to compact. Must be a valid database name (alphanumeric, underscores, hyphens, no spaces, 1-64 chars).",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 64,
              "pattern": "^[a-zA-Z0-9_-]+$"
            },
            "example": "testdb"
          },
          {
            "name": "collection",
            "in": "path",
            "description": "The name of the collection to compact. Must be a valid collection name (alphanumeric, underscores, hyphens, no spaces, 1-120 chars).",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 120,
              "pattern": "^[a-zA-Z0-9._-]+$"
            },
            "example": "users"
          }
        ],
        "responses": {
          "302": {
            "description": "Redirects back to the previous page. On success, a success message is set in the user's session. On error, an error message is set in the session.",
            "headers": {
              "Location": {
                "description": "URL to redirect the client back to.",
                "schema": {
                  "type": "string",
                  "example": "https://yourdomain/db/testdb/collection/users"
                }
              }
            },
            "content": {
              "text/html": {
                "schema": {
                  "type": "string",
                  "description": "No response body. The client is redirected."
                }
              }
            }
          },
          "400": {
            "description": "Invalid database or collection name.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid database or collection name."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication credentials were missing or incorrect.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required."
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. The authenticated user does not have permission to compact the collection.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "You do not have permission to perform this operation."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error during compaction.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Failed to compact collection: <error details>"
                    }
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "basicAuth": [],
            "oidcAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "collections",
        "sensitive_information": true
      }
    },
    "/db/:database/gridfs/:bucket": {
      "delete": {
        "summary": "Delete a GridFS Bucket",
        "api_description": "This endpoint deletes an entire GridFS bucket (including all files and chunks collections) from the specified MongoDB database. The operation is destructive and cannot be undone. The endpoint requires authentication and appropriate permissions. The 'database' and 'bucket' parameters must refer to an existing MongoDB database and a valid GridFS bucket in that database. If the bucket does not exist, an error is returned. The request must include a valid CSRF token in the 'x-csrf-token' header and, depending on configuration, may require Basic Auth or OIDC authentication. This action is sensitive as it removes all files stored in the specified bucket.",
        "tags": [
          "GridfsBuckets"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "required": true,
            "description": "Name of the MongoDB database containing the GridFS bucket.",
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9_\\-]+$",
              "minLength": 1,
              "maxLength": 64
            },
            "example": "mydatabase"
          },
          {
            "name": "bucket",
            "in": "path",
            "required": true,
            "description": "Name of the GridFS bucket to be deleted.",
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9_\\-]+$",
              "minLength": 1,
              "maxLength": 64
            },
            "example": "mybucket"
          }
        ],
        "requestBody": {
          "required": false
        },
        "security": [
          {
            "basicAuth": [],
            "oidcAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "gridfs",
        "sensitive_information": true,
        "responses": {
          "200": {
            "description": "GridFS bucket deleted successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Bucket 'mybucket' deleted successfully from database 'mydatabase'."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid parameters or request.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid database or bucket name."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Authentication required or failed.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized: Authentication credentials were missing or incorrect."
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - insufficient permissions or missing CSRF token.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Forbidden: You do not have permission to delete this bucket or CSRF token is missing/invalid."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Bucket or database not found.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Bucket 'mybucket' not found in database 'mydatabase'."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "An unexpected error occurred while deleting the bucket."
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "List All Files in a GridFS Bucket",
        "api_description": "Retrieves a list of all files stored in a specific GridFS bucket within a MongoDB database. The endpoint requires both database and bucket names as path parameters. It returns an array of file metadata, including filename and file size (human-readable), and summary statistics such as average chunk size and total bucket size. The endpoint is protected by authentication (Basic Auth and/or OIDC, depending on configuration) and CSRF protection. Only authenticated users can access this endpoint. The response excludes sensitive file data and only provides metadata. Parameters must be valid MongoDB database and bucket names; invalid or non-existent buckets will result in an error.",
        "tags": [
          "GridfsBuckets"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "The name of the MongoDB database containing the GridFS bucket.",
            "required": true,
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9_\\-]+$",
              "example": "mydatabase"
            }
          },
          {
            "name": "bucket",
            "in": "path",
            "description": "The name of the GridFS bucket whose files are to be listed.",
            "required": true,
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9_\\-]+$",
              "example": "mybucket"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "A list of files in the specified GridFS bucket, including metadata and bucket statistics.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "title": {
                      "type": "string",
                      "example": "Viewing Bucket: mybucket"
                    },
                    "buckets": {
                      "type": "array",
                      "description": "List of available GridFS buckets in the database.",
                      "items": {
                        "type": "string",
                        "example": "mybucket"
                      }
                    },
                    "columns": {
                      "type": "array",
                      "description": "List of columns present in the files metadata.",
                      "items": {
                        "type": "string",
                        "example": "filename"
                      }
                    },
                    "files": {
                      "type": "array",
                      "description": "Array of file metadata objects.",
                      "items": {
                        "type": "object",
                        "properties": {
                          "filename": {
                            "type": "string",
                            "example": "example.txt"
                          },
                          "length": {
                            "type": "string",
                            "description": "File size in human-readable format.",
                            "example": "1.2 MB"
                          },
                          "uploadDate": {
                            "type": "string",
                            "format": "date-time",
                            "example": "2024-06-18T13:20:15.123Z"
                          },
                          "contentType": {
                            "type": "string",
                            "example": "text/plain"
                          },
                          "_id": {
                            "type": "string",
                            "description": "Unique file identifier (ObjectId as string).",
                            "example": "665f1c0e3b5f1a7b2c3d4e5f"
                          }
                        },
                        "required": [
                          "filename",
                          "length",
                          "uploadDate",
                          "contentType",
                          "_id"
                        ]
                      }
                    },
                    "csrfToken": {
                      "type": "string",
                      "description": "CSRF token for form submissions.",
                      "example": "2a0b1c2d3e4f5g6h7i8j9k0l"
                    },
                    "stats": {
                      "type": "object",
                      "description": "Statistics for the bucket.",
                      "properties": {
                        "avgChunk": {
                          "type": "string",
                          "description": "Average chunk size in human-readable format.",
                          "example": "255 KB"
                        },
                        "totalSize": {
                          "type": "string",
                          "description": "Total size of all files in the bucket (human-readable).",
                          "example": "12.5 MB"
                        }
                      },
                      "required": [
                        "avgChunk",
                        "totalSize"
                      ]
                    }
                  },
                  "required": [
                    "title",
                    "buckets",
                    "columns",
                    "files",
                    "csrfToken",
                    "stats"
                  ]
                },
                "examples": {
                  "success": {
                    "value": {
                      "title": "Viewing Bucket: mybucket",
                      "buckets": [
                        "mybucket",
                        "otherbucket"
                      ],
                      "columns": [
                        "filename",
                        "length",
                        "uploadDate",
                        "contentType"
                      ],
                      "files": [
                        {
                          "filename": "example.txt",
                          "length": "1.2 MB",
                          "uploadDate": "2024-06-18T13:20:15.123Z",
                          "contentType": "text/plain",
                          "_id": "665f1c0e3b5f1a7b2c3d4e5f"
                        },
                        {
                          "filename": "photo.jpg",
                          "length": "2.3 MB",
                          "uploadDate": "2024-06-17T11:05:10.999Z",
                          "contentType": "image/jpeg",
                          "_id": "665f1c0e3b5f1a7b2c3d4e60"
                        }
                      ],
                      "csrfToken": "2a0b1c2d3e4f5g6h7i8j9k0l",
                      "stats": {
                        "avgChunk": "255 KB",
                        "totalSize": "12.5 MB"
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid database or bucket name, or bucket does not exist.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "mybucket.files collection not found!"
                    }
                  },
                  "required": [
                    "error"
                  ]
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Authentication required or failed.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required."
                    }
                  },
                  "required": [
                    "error"
                  ]
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - CSRF token missing or invalid, or insufficient permissions.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid CSRF token."
                    }
                  },
                  "required": [
                    "error"
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Internal server error.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unexpected server error."
                    }
                  },
                  "required": [
                    "error"
                  ]
                }
              }
            }
          }
        },
        "security": [
          {
            "basicAuth": [],
            "oidcAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "gridfs",
        "sensitive_information": false
      },
      "post": {
        "summary": "Upload a File to GridFS Bucket",
        "api_description": "This endpoint allows an authenticated user to upload a file to a specified GridFS bucket within a MongoDB database. The file is uploaded using multipart/form-data. The endpoint requires authentication via either Basic Auth or OIDC (OpenID Connect), depending on configuration. The path parameters specify the target database and bucket. The request body must include the file to upload, and may include optional metadata fields. File uploads are subject to the server's configured request size limit. The endpoint also requires a CSRF token to be sent as a form field for protection. Only authenticated users can access this endpoint. The uploaded file is stored as a new GridFS file in the specified bucket. If the bucket does not exist, it will be created automatically.",
        "tags": [
          "Gridfs"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "The name of the MongoDB database.",
            "required": true,
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9_\\-]+$",
              "minLength": 1,
              "example": "mydb"
            }
          },
          {
            "name": "bucket",
            "in": "path",
            "description": "The name of the GridFS bucket.",
            "required": true,
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9_\\-]+$",
              "minLength": 1,
              "example": "mybucket"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "file": {
                    "type": "string",
                    "format": "binary",
                    "description": "The file to upload."
                  },
                  "filename": {
                    "type": "string",
                    "description": "Optional filename for the uploaded file. If not provided, the original file name is used.",
                    "example": "report.pdf"
                  },
                  "metadata": {
                    "type": "object",
                    "description": "Optional metadata to associate with the file.",
                    "additionalProperties": {
                      "type": "string"
                    },
                    "example": {
                      "author": "John Doe",
                      "description": "Monthly report"
                    }
                  },
                  "csrfToken": {
                    "type": "string",
                    "description": "CSRF token for request validation. Required unless CSRF is disabled in test mode."
                  }
                },
                "required": [
                  "file",
                  "csrfToken"
                ]
              },
              "encoding": {
                "file": {
                  "contentType": [
                    "application/octet-stream",
                    "application/pdf",
                    "image/png",
                    "image/jpeg",
                    "text/plain"
                  ]
                }
              }
            }
          }
        },
        "security": [
          {
            "basicAuth": []
          },
          {
            "oidc": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "gridfs",
        "sensitive_information": true,
        "responses": {
          "200": {
            "description": "File uploaded successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "File uploaded successfully"
                    },
                    "file": {
                      "type": "object",
                      "properties": {
                        "_id": {
                          "type": "string",
                          "description": "The unique identifier of the uploaded file.",
                          "example": "60d5ec49a3c2f9b6c8b45678"
                        },
                        "filename": {
                          "type": "string",
                          "description": "The name of the uploaded file.",
                          "example": "report.pdf"
                        },
                        "length": {
                          "type": "integer",
                          "description": "Size of the file in bytes.",
                          "example": 123456
                        },
                        "chunkSize": {
                          "type": "integer",
                          "description": "Chunk size used by GridFS in bytes.",
                          "example": 261120
                        },
                        "uploadDate": {
                          "type": "string",
                          "format": "date-time",
                          "description": "The upload date and time.",
                          "example": "2024-06-01T12:34:56.789Z"
                        },
                        "metadata": {
                          "type": "object",
                          "description": "User-provided metadata for the file.",
                          "additionalProperties": {
                            "type": "string"
                          },
                          "example": {
                            "author": "John Doe",
                            "description": "Monthly report"
                          }
                        }
                      }
                    }
                  }
                },
                "examples": {
                  "success": {
                    "summary": "Successful Upload",
                    "value": {
                      "message": "File uploaded successfully",
                      "file": {
                        "_id": "60d5ec49a3c2f9b6c8b45678",
                        "filename": "report.pdf",
                        "length": 123456,
                        "chunkSize": 261120,
                        "uploadDate": "2024-06-01T12:34:56.789Z",
                        "metadata": {
                          "author": "John Doe",
                          "description": "Monthly report"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad Request (e.g., missing file, invalid parameters, or file too large)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "No file uploaded"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized (authentication failed or missing)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden (CSRF token missing/invalid or insufficient permissions)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid CSRF token"
                    }
                  }
                }
              }
            }
          },
          "413": {
            "description": "Payload Too Large (file exceeds configured request size limit)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "File size exceeds limit"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error (unexpected failure)",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Failed to upload file"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/db/:database/dropindex/:collection": {
      "get": {
        "summary": "Drop an Index from a Collection",
        "api_description": "This endpoint allows an authenticated user to drop (delete) an index from a given MongoDB collection within a specified database. The operation requires the name of the index to be provided as a query parameter. The endpoint enforces several configuration-based restrictions: if the server is in read-only mode or index/collection deletion is disabled, the operation will be blocked. The endpoint requires authentication (Basic Auth or OIDC, depending on configuration) and CSRF protection. Upon success or failure, the user is redirected back to the previous page (typically in a browser context). This operation is sensitive and should not be exposed to unauthorized users, as it can impact database performance or availability.",
        "tags": [
          "Databases"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "required": true,
            "description": "The name of the MongoDB database.",
            "schema": {
              "type": "string",
              "example": "mydb"
            }
          },
          {
            "name": "collection",
            "in": "path",
            "required": true,
            "description": "The name of the collection from which the index should be dropped.",
            "schema": {
              "type": "string",
              "example": "users"
            }
          },
          {
            "name": "name",
            "in": "query",
            "required": true,
            "description": "The name of the index to be dropped.",
            "schema": {
              "type": "string",
              "example": "username_1"
            }
          },
          {
            "name": "csrf-token",
            "in": "header",
            "required": true,
            "description": "CSRF token for protection against cross-site request forgery. This must match the token provided in the user's session/cookie.",
            "schema": {
              "type": "string",
              "example": "abcd1234efgh5678"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "required": true,
            "description": "Basic authorization header or OIDC Bearer token, depending on server configuration.",
            "schema": {
              "type": "string",
              "example": "Basic YWRtaW46cGFzcw=="
            }
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "databases",
        "sensitive_information": true,
        "responses": {
          "302": {
            "description": "Redirect to previous page after dropping the index or on error. The result of the operation is available in the user's session (success or error message).",
            "headers": {
              "Location": {
                "description": "The URL to redirect back to the previous page.",
                "schema": {
                  "type": "string",
                  "example": "/db/mydb/collection/users"
                }
              }
            },
            "content": {
              "text/html": {
                "schema": {
                  "type": "string",
                  "example": "<!DOCTYPE html><html><head><title>Redirecting...</title></head><body>Redirecting back...</body></html>"
                }
              }
            }
          },
          "400": {
            "description": "Missing required parameters or invalid operation due to configuration (e.g., read-only mode or deletion disabled).",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "examples": [
                        "Error: missing name parameter",
                        "Error: config.options.readOnly is set to true",
                        "Error: config.options.noDelete is set to true"
                      ]
                    }
                  }
                },
                "examples": {
                  "missing_name": {
                    "value": {
                      "error": "Error: missing name parameter"
                    }
                  },
                  "read_only": {
                    "value": {
                      "error": "Error: config.options.readOnly is set to true"
                    }
                  },
                  "no_delete": {
                    "value": {
                      "error": "Error: config.options.noDelete is set to true"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Authentication failed or missing. User is not authorized to perform this operation.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "CSRF token missing or invalid, or user is forbidden from performing this operation due to configuration.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Forbidden"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error or database error occurred while dropping the index.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Error: <database error message>"
                    }
                  }
                }
              }
            }
          }
        },
        "examples": {
          "request": {
            "summary": "Example request to drop an index",
            "value": {
              "method": "GET",
              "url": "/db/mydb/dropindex/users?name=username_1",
              "headers": {
                "Authorization": "Basic YWRtaW46cGFzcw==",
                "csrf-token": "abcd1234efgh5678"
              }
            }
          },
          "response_success": {
            "summary": "Successful index drop (redirect)",
            "value": {
              "status": 302,
              "headers": {
                "Location": "/db/mydb/collection/users"
              },
              "body": "<!DOCTYPE html><html><head><title>Redirecting...</title></head><body>Redirecting back...</body></html>"
            }
          },
          "response_error": {
            "summary": "Error due to missing index name",
            "value": {
              "status": 400,
              "body": {
                "error": "Error: missing name parameter"
              }
            }
          }
        }
      }
    },
    "/db/:database/gridfs/:bucket/:file": {
      "get": {
        "summary": "Download a file from a GridFS bucket",
        "api_description": "This endpoint allows clients to download a specific file from a MongoDB GridFS bucket within a given database. The endpoint requires the database name, the bucket name, and the file identifier as path parameters. The file identifier is expected to be a valid MongoDB ObjectId or a compatible binary identifier. The endpoint enforces authentication (Basic Auth and/or OIDC, depending on server configuration) and CSRF protection. On success, the file is streamed back with appropriate Content-Type and Content-Disposition headers. If the file does not exist or an error occurs, a redirect with an error message is triggered. Parameter limitations: 'database' and 'bucket' must refer to existing entities; 'file' must be a valid file identifier present in the bucket.",
        "tags": [
          "Gridfs"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "Name of the MongoDB database containing the GridFS bucket.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "example": "testdb"
            }
          },
          {
            "name": "bucket",
            "in": "path",
            "description": "Name of the GridFS bucket.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "example": "myfiles"
            }
          },
          {
            "name": "file",
            "in": "path",
            "description": "File identifier (ObjectId or compatible binary identifier) for the file to download. Should be URI-encoded.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "example": "64d2b2e2e2e2e2e2e2e2e2e2"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "File found and streamed successfully. The response is a binary file stream.",
            "content": {
              "application/octet-stream": {
                "schema": {
                  "type": "string",
                  "format": "binary",
                  "description": "Binary stream of the requested file."
                },
                "examples": {
                  "example1": {
                    "summary": "Sample file download",
                    "description": "A sample binary file stream response.",
                    "value": "<binary content>"
                  }
                }
              }
            },
            "headers": {
              "Content-Type": {
                "description": "The MIME type of the file.",
                "schema": {
                  "type": "string",
                  "example": "application/pdf"
                }
              },
              "Content-Disposition": {
                "description": "Indicates that the file should be downloaded as an attachment with the original filename.",
                "schema": {
                  "type": "string",
                  "example": "attachment; filename=\"sample.pdf\""
                }
              }
            }
          },
          "400": {
            "description": "Invalid parameters or file identifier.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid file identifier"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication is required to access this endpoint.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "File not found in the specified bucket.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "File not found"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error during file retrieval or streaming.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Internal server error"
                    }
                  }
                }
              }
            }
          }
        },
        "security": [
          {
            "basicAuth": [],
            "oidc": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "gridfs",
        "sensitive_information": true
      },
      "delete": {
        "summary": "Delete a File from a GridFS Bucket",
        "api_description": "This endpoint permanently deletes a specific file from a GridFS bucket in a MongoDB database. The operation requires the names of the database, bucket, and the file identifier. The file identifier supports both ObjectId and binary UUID formats. Authorization is required, and CSRF protection is enforced. The endpoint does not support soft deletion; the file and its chunks are removed from storage. If the file does not exist, an error is returned. Only authenticated users with appropriate permissions can perform this action.",
        "tags": [
          "GridfsFiles"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "The name of the MongoDB database containing the GridFS bucket.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "pattern": "^[a-zA-Z0-9._-]+$"
            },
            "example": "myDatabase"
          },
          {
            "name": "bucket",
            "in": "path",
            "description": "The name of the GridFS bucket from which the file will be deleted.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "pattern": "^[a-zA-Z0-9._-]+$"
            },
            "example": "myBucket"
          },
          {
            "name": "file",
            "in": "path",
            "description": "The identifier of the file to delete. Accepts a MongoDB ObjectId (hex string) or a binary UUID (with optional 'subtype' query parameter). Must be URL-encoded if not a simple string.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1
            },
            "example": "64b3f8c2e8f8c2e8f8c2e8f8"
          },
          {
            "name": "subtype",
            "in": "query",
            "description": "Optional binary subtype for file IDs that are not ObjectIds. Only subtype 3 and 4 are allowed for UUIDs.",
            "required": false,
            "schema": {
              "type": "integer",
              "enum": [
                3,
                4
              ]
            },
            "example": 4
          }
        ],
        "security": [
          {
            "basicAuth": [],
            "oidcAuth": []
          }
        ],
        "requestBody": {
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {}
              }
            }
          }
        },
        "authorization_tag": "Authorization Required",
        "module_tag": "gridfs",
        "sensitive_information": true,
        "responses": {
          "200": {
            "description": "File deleted successfully from the GridFS bucket.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "File _id: \"64b3f8c2e8f8c2e8f8c2e8f8\" deleted!"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid input or file identifier format.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid file identifier format."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication credentials are missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required."
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. The authenticated user does not have permission to delete this file.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "You do not have permission to delete this file."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "File or bucket not found.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "File not found!"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error while attempting to delete the file.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Error: Database operation failed."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/db/:database/gridfs": {
      "post": {
        "summary": "Create a new GridFS Bucket in a Database",
        "api_description": "This endpoint allows an authenticated user to create a new GridFS bucket within a specified MongoDB database. The bucket name must be unique within the database and adhere to MongoDB collection naming rules (cannot contain the characters $, null character, or start with 'system.'). The user must have write access to the database. The endpoint enforces authentication via Basic Auth or OIDC (OpenID Connect), and also requires a valid CSRF token. If the bucket already exists or the request is malformed, appropriate error responses are returned.",
        "tags": [
          "GridfsBuckets"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "The name of the MongoDB database where the new GridFS bucket will be created.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "pattern": "^[^\\s\\$\\.\\x00]+$"
            },
            "example": "mydatabase"
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "bucketName": {
                    "type": "string",
                    "description": "The name of the new GridFS bucket to create. Must be a valid MongoDB collection name and unique within the database.",
                    "minLength": 1,
                    "pattern": "^(?!system\\.)[^\\s\\$\\.\\x00]+$",
                    "example": "userfiles"
                  }
                },
                "required": [
                  "bucketName"
                ]
              },
              "example": {
                "bucketName": "userfiles"
              }
            },
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "bucketName": {
                    "type": "string",
                    "description": "The name of the new GridFS bucket to create. Must be a valid MongoDB collection name and unique within the database.",
                    "minLength": 1,
                    "pattern": "^(?!system\\.)[^\\s\\$\\.\\x00]+$",
                    "example": "userfiles"
                  }
                },
                "required": [
                  "bucketName"
                ]
              }
            }
          }
        },
        "security": [
          {
            "basicAuth": [],
            "oidcAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "gridfs",
        "sensitive_information": false,
        "responses": {
          "200": {
            "description": "GridFS bucket created successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "GridFS bucket 'userfiles' created successfully."
                    },
                    "bucketName": {
                      "type": "string",
                      "example": "userfiles"
                    },
                    "database": {
                      "type": "string",
                      "example": "mydatabase"
                    }
                  }
                }
              }
            }
          },
          "201": {
            "description": "GridFS bucket created successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "GridFS bucket 'userfiles' created successfully."
                    },
                    "bucketName": {
                      "type": "string",
                      "example": "userfiles"
                    },
                    "database": {
                      "type": "string",
                      "example": "mydatabase"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request. Possible reasons: missing bucket name, invalid bucket name, or bucket already exists.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid bucket name."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication credentials are missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required."
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. User does not have permission to create a bucket in this database.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "You do not have permission to create a bucket in this database."
                    }
                  }
                }
              }
            }
          },
          "409": {
            "description": "Conflict. A GridFS bucket with the same name already exists.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Bucket 'userfiles' already exists."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "An unexpected error occurred while creating the GridFS bucket."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/db/:database/:collection": {
      "get": {
        "summary": "View Database Collection",
        "api_description": "Retrieves detailed information about a specific collection within a MongoDB database. This endpoint returns metadata and statistics for the given collection, including the number of documents, storage size, index size, and other statistics if the user has admin privileges. The endpoint requires authentication, and access is controlled via Basic Auth or OIDC depending on configuration. CSRF protection is enforced. The path parameters must be valid MongoDB database and collection names; otherwise, an error is returned. This endpoint does not return the collection's documents, but rather collection-level metadata and stats.",
        "tags": [
          "Databases"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "The name of the MongoDB database to view. Must be a valid database name as per MongoDB naming conventions.",
            "required": true,
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9_\\-]+$",
              "minLength": 1,
              "maxLength": 64,
              "example": "testdb"
            }
          },
          {
            "name": "collection",
            "in": "path",
            "description": "The name of the collection within the specified database. Must be a valid collection name as per MongoDB naming conventions.",
            "required": true,
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9_\\-\\.]+$",
              "minLength": 1,
              "maxLength": 120,
              "example": "users"
            }
          },
          {
            "name": "csrf-token",
            "in": "header",
            "description": "CSRF token required for requests if CSRF protection is enabled. Usually provided as a cookie or header.",
            "required": false,
            "schema": {
              "type": "string",
              "example": "XSRF-TOKEN"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "description": "Basic authentication header in the format 'Basic base64(username:password)'. Required if Basic Auth is enabled.",
            "required": false,
            "schema": {
              "type": "string",
              "example": "Basic YWRtaW46cGFzcw=="
            }
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "databases",
        "sensitive_information": true,
        "responses": {
          "200": {
            "description": "Successfully retrieved database collection metadata and statistics.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "title": {
                      "type": "string",
                      "example": "Viewing Database: testdb"
                    },
                    "databases": {
                      "type": "array",
                      "description": "List of available databases.",
                      "items": {
                        "type": "string",
                        "example": "testdb"
                      }
                    },
                    "colls": {
                      "type": "array",
                      "description": "List of collections in the selected database.",
                      "items": {
                        "type": "string",
                        "example": "users"
                      }
                    },
                    "grids": {
                      "type": "array",
                      "description": "List of GridFS buckets in the selected database.",
                      "items": {
                        "type": "string",
                        "example": "fs"
                      }
                    },
                    "csrfToken": {
                      "type": "string",
                      "description": "CSRF token for subsequent requests.",
                      "example": "XSRF-TOKEN"
                    },
                    "stats": {
                      "type": [
                        "object",
                        "boolean"
                      ],
                      "description": "Database statistics if user has admin privileges, otherwise false.",
                      "properties": {
                        "avgObjSize": {
                          "type": "string",
                          "description": "Average object size in human-readable format.",
                          "example": "1.2 KB"
                        },
                        "collections": {
                          "type": "integer",
                          "description": "Number of collections in the database.",
                          "example": 5
                        },
                        "dataFileVersion": {
                          "type": [
                            "string",
                            "null"
                          ],
                          "description": "Data file version (major.minor) if available.",
                          "example": "4.2"
                        },
                        "dataSize": {
                          "type": "string",
                          "description": "Total data size in human-readable format.",
                          "example": "15.8 MB"
                        },
                        "extentFreeListNum": {
                          "type": [
                            "integer",
                            "null"
                          ],
                          "description": "Number of free extents, if available.",
                          "example": 2
                        },
                        "fileSize": {
                          "type": [
                            "string",
                            "null"
                          ],
                          "description": "Total file size in human-readable format, or null if unavailable.",
                          "example": "20 MB"
                        },
                        "indexes": {
                          "type": "integer",
                          "description": "Number of indexes in the database.",
                          "example": 3
                        },
                        "indexSize": {
                          "type": "string",
                          "description": "Total size of all indexes in human-readable format.",
                          "example": "1.5 MB"
                        },
                        "numExtents": {
                          "type": [
                            "string",
                            "null"
                          ],
                          "description": "Number of extents as a string, or null if unavailable.",
                          "example": "10"
                        },
                        "objects": {
                          "type": "integer",
                          "description": "Number of objects/documents in the database.",
                          "example": 10000
                        },
                        "storageSize": {
                          "type": "string",
                          "description": "Total storage size in human-readable format.",
                          "example": "18 MB"
                        }
                      },
                      "example": {
                        "avgObjSize": "1.2 KB",
                        "collections": 5,
                        "dataFileVersion": "4.2",
                        "dataSize": "15.8 MB",
                        "extentFreeListNum": 2,
                        "fileSize": "20 MB",
                        "indexes": 3,
                        "indexSize": "1.5 MB",
                        "numExtents": "10",
                        "objects": 10000,
                        "storageSize": "18 MB"
                      }
                    }
                  }
                },
                "examples": {
                  "success": {
                    "summary": "Successful Response",
                    "value": {
                      "title": "Viewing Database: testdb",
                      "databases": [
                        "testdb",
                        "admin"
                      ],
                      "colls": [
                        "users",
                        "products"
                      ],
                      "grids": [
                        "fs"
                      ],
                      "csrfToken": "XSRF-TOKEN",
                      "stats": {
                        "avgObjSize": "1.2 KB",
                        "collections": 5,
                        "dataFileVersion": "4.2",
                        "dataSize": "15.8 MB",
                        "extentFreeListNum": 2,
                        "fileSize": "20 MB",
                        "indexes": 3,
                        "indexSize": "1.5 MB",
                        "numExtents": "10",
                        "objects": 10000,
                        "storageSize": "18 MB"
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid database or collection name, or error refreshing collections.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "That database name is invalid."
                    }
                  }
                },
                "examples": {
                  "invalid_name": {
                    "summary": "Invalid Name",
                    "value": {
                      "error": "That database name is invalid."
                    }
                  },
                  "refresh_error": {
                    "summary": "Could not refresh collections",
                    "value": {
                      "error": "Could not refresh collections. {\"message\":\"MongoDB connection error\"}"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication credentials are missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. CSRF token missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid CSRF token"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Database or collection not found.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Collection not found!"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Could not get stats. {\"message\":\"Internal error\"}"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete Collection or Documents in a Collection",
        "api_description": "Deletes an entire collection or a subset of documents from a specified collection within a database. If a query parameter is provided, only documents matching the query are deleted. If no query parameter is provided, the entire collection is dropped. The endpoint enforces configuration-based restrictions: if the server is in read-only mode or collection deletion is disabled (`config.options.readOnly` or `config.options.noDelete`), the operation is rejected. Requires authentication (Basic Auth or OIDC, depending on server configuration). Path parameters must be valid MongoDB database and collection names. Query parameter, if provided, must be a valid JSON query string.",
        "tags": [
          "Collections"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "The name of the database containing the collection to delete or modify.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 63,
              "pattern": "^[^/\\. \"$*<>:|?]+$"
            },
            "example": "myDatabase"
          },
          {
            "name": "collection",
            "in": "path",
            "description": "The name of the collection to delete or from which to remove documents.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 255,
              "pattern": "^[^/\\. \"$*<>:|?]+$"
            },
            "example": "users"
          },
          {
            "name": "query",
            "in": "query",
            "description": "A JSON string representing the filter for documents to delete. If omitted, the entire collection will be dropped.",
            "required": false,
            "schema": {
              "type": "string"
            },
            "example": "{\"status\": \"inactive\"}"
          }
        ],
        "security": [
          {
            "basicAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "collections",
        "sensitive_information": true,
        "responses": {
          "200": {
            "description": "Successful deletion. If a query was provided, returns the number of documents deleted. If the collection was dropped, returns a confirmation message.",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "type": "object",
                      "properties": {
                        "deletedCount": {
                          "type": "integer",
                          "description": "Number of documents deleted.",
                          "example": 5
                        },
                        "collection": {
                          "type": "string",
                          "description": "Collection name.",
                          "example": "users"
                        },
                        "message": {
                          "type": "string",
                          "description": "Success message.",
                          "example": "5 documents deleted from \"users\""
                        }
                      }
                    },
                    {
                      "type": "object",
                      "properties": {
                        "collection": {
                          "type": "string",
                          "description": "Collection name.",
                          "example": "users"
                        },
                        "message": {
                          "type": "string",
                          "description": "Success message.",
                          "example": "Collection \"users\" deleted!"
                        }
                      }
                    }
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Bad Request. Invalid database or collection name, or invalid query format.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid collection name."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication is required.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required."
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. Deletion is not allowed due to server configuration (read-only or deletion disabled).",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Error: config.options.readOnly is set to true"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error. An unexpected error occurred during the deletion process.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Something went wrong: <error details>"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "summary": "Create a new collection in a specified database",
        "api_description": "This endpoint creates a new collection within a specified MongoDB database. The database and collection names are provided as path parameters. The request body must contain the name of the collection to be created. The endpoint enforces validation on the collection name to ensure it meets MongoDB naming requirements. Authentication is required via Basic Auth or OIDC, and CSRF protection is enforced via a CSRF token in the request. If the collection name is invalid or already exists, an error is returned. On success, the collection is created and the user is redirected to the new collection's page.",
        "tags": [
          "Collections"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "The name of the database in which to create the collection.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "pattern": "^[^\\s\\.\\$/\\\\\\\"\\*\\<\\>\\:\\|\\?]+$"
            },
            "example": "example_db"
          },
          {
            "name": "collection",
            "in": "path",
            "description": "The name of the collection to create.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "pattern": "^(?!system\\.).+"
            },
            "example": "new_collection"
          },
          {
            "name": "X-CSRF-Token",
            "in": "header",
            "description": "CSRF protection token. Required unless the server is running in test mode.",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "a1b2c3d4e5f6g7h8"
          },
          {
            "name": "Authorization",
            "in": "header",
            "description": "Basic authentication header (if Basic Auth is enabled) or Bearer token (if OIDC is enabled).",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "Basic YWRtaW46cGFzcw=="
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "collection": {
                    "type": "string",
                    "description": "The name of the collection to create. Must be a valid MongoDB collection name.",
                    "minLength": 1,
                    "pattern": "^(?!system\\.).+"
                  }
                },
                "required": [
                  "collection"
                ],
                "example": {
                  "collection": "users"
                }
              }
            },
            "application/x-www-form-urlencoded": {
              "schema": {
                "type": "object",
                "properties": {
                  "collection": {
                    "type": "string",
                    "description": "The name of the collection to create. Must be a valid MongoDB collection name.",
                    "minLength": 1,
                    "pattern": "^(?!system\\.).+"
                  }
                },
                "required": [
                  "collection"
                ],
                "example": {
                  "collection": "users"
                }
              }
            }
          }
        },
        "authorization_tag": "Authorization Required",
        "module_tag": "collections",
        "sensitive_information": true,
        "responses": {
          "302": {
            "description": "Redirect to the new collection's page after successful creation.",
            "headers": {
              "Location": {
                "description": "URL of the newly created collection page.",
                "schema": {
                  "type": "string",
                  "example": "/db/example_db/users"
                }
              }
            },
            "content": {
              "text/html": {
                "schema": {
                  "type": "string",
                  "example": "<html><head><meta http-equiv=\"refresh\" content=\"0; url=/db/example_db/users\"></head><body>Redirecting...</body></html>"
                }
              }
            }
          },
          "400": {
            "description": "Invalid collection name or missing required parameters.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid collection name."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Authentication failed. Invalid or missing credentials.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Unauthorized"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "CSRF token missing or invalid, or user does not have permission.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid CSRF token."
                    }
                  }
                }
              }
            }
          },
          "409": {
            "description": "Collection already exists.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Collection already exists."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Something went wrong: <error details>"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "put": {
        "summary": "Update Collection in Database",
        "api_description": "This endpoint updates or replaces a collection within a specified MongoDB database. The operation requires the user to be authenticated, and CSRF protection is enforced unless running in a test environment. The endpoint expects the database and collection names as path parameters. The request body should contain the update instructions (such as documents to insert, update, or replace). The endpoint validates input, handles authorization (Basic Auth or OIDC if enabled), and performs the update operation. If the request is invalid or authorization fails, appropriate error responses are returned. This operation may touch sensitive data within the specified database/collection.",
        "tags": [
          "Databases"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9_\\-]+$",
              "description": "The name of the MongoDB database. Must be a valid MongoDB database name."
            },
            "description": "The target database name."
          },
          {
            "name": "collection",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string",
              "pattern": "^[a-zA-Z0-9_\\-]+$",
              "description": "The name of the collection inside the database. Must be a valid MongoDB collection name."
            },
            "description": "The target collection name."
          },
          {
            "name": "X-CSRF-Token",
            "in": "header",
            "required": true,
            "schema": {
              "type": "string"
            },
            "description": "CSRF token for request validation."
          },
          {
            "name": "Authorization",
            "in": "header",
            "required": false,
            "schema": {
              "type": "string",
              "description": "HTTP Basic Auth header (if enabled), or OIDC Bearer token (if enabled)."
            },
            "description": "Authorization credentials. Required if Basic Auth or OIDC is enabled."
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "documents": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "description": "A document to insert or update in the collection. Arbitrary JSON object."
                    },
                    "description": "The array of documents to be inserted, updated, or replaced in the collection."
                  },
                  "filter": {
                    "type": "object",
                    "description": "A MongoDB filter object describing which documents to update."
                  },
                  "update": {
                    "type": "object",
                    "description": "A MongoDB update object (e.g., { \"$set\": { ... } })."
                  },
                  "options": {
                    "type": "object",
                    "description": "Additional options for the update operation (e.g., upsert, multi)."
                  }
                },
                "oneOf": [
                  {
                    "required": [
                      "documents"
                    ]
                  },
                  {
                    "required": [
                      "filter",
                      "update"
                    ]
                  }
                ],
                "description": "Either provide an array of documents for insertion/replacement, or a filter and update object for updating existing documents."
              },
              "examples": {
                "InsertDocuments": {
                  "summary": "Insert multiple documents",
                  "value": {
                    "documents": [
                      {
                        "name": "Alice",
                        "age": 30
                      },
                      {
                        "name": "Bob",
                        "age": 25
                      }
                    ]
                  }
                },
                "UpdateDocuments": {
                  "summary": "Update documents with filter",
                  "value": {
                    "filter": {
                      "name": "Alice"
                    },
                    "update": {
                      "$set": {
                        "age": 31
                      }
                    },
                    "options": {
                      "multi": true
                    }
                  }
                }
              }
            }
          }
        },
        "authorization_tag": "Authorization Required",
        "module_tag": "databases",
        "sensitive_information": true,
        "responses": {
          "200": {
            "description": "Collection updated successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "acknowledged": {
                      "type": "boolean",
                      "example": true,
                      "description": "Indicates if the operation was acknowledged by the database."
                    },
                    "matchedCount": {
                      "type": "integer",
                      "example": 1,
                      "description": "Number of documents matched by the filter (for update operations)."
                    },
                    "modifiedCount": {
                      "type": "integer",
                      "example": 1,
                      "description": "Number of documents actually modified (for update operations)."
                    },
                    "upsertedCount": {
                      "type": "integer",
                      "example": 0,
                      "description": "Number of documents upserted (for upsert operations)."
                    },
                    "insertedIds": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      },
                      "example": [
                        "60c72b2f9b1e8b3f8c8e4b1a"
                      ],
                      "description": "Array of inserted document IDs (for insert operations)."
                    },
                    "message": {
                      "type": "string",
                      "example": "Collection updated successfully."
                    }
                  }
                },
                "examples": {
                  "UpdateResponse": {
                    "summary": "Update operation response",
                    "value": {
                      "acknowledged": true,
                      "matchedCount": 1,
                      "modifiedCount": 1,
                      "upsertedCount": 0,
                      "message": "Collection updated successfully."
                    }
                  },
                  "InsertResponse": {
                    "summary": "Insert operation response",
                    "value": {
                      "acknowledged": true,
                      "insertedIds": [
                        "60c72b2f9b1e8b3f8c8e4b1a",
                        "60c72b2f9b1e8b3f8c8e4b1b"
                      ],
                      "message": "Documents inserted successfully."
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid input, missing parameters, or invalid database/collection name.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid database or collection name."
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Authorization credentials missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required."
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - CSRF token missing or invalid, or insufficient permissions.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "CSRF token missing or invalid."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found - The specified database or collection does not exist.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Database or collection not found."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error - An unexpected error occurred during the operation.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "An error occurred while updating the collection."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/prisms/{prism_id}": {
      "get": {
        "summary": "Get Prism Details",
        "api_description": "Retrieves details about a specific prism by its unique identifier. The endpoint expects a valid prism_id as a path parameter. The prism_id must be a non-empty string. Returns the prism's id, name, and status. No authentication or authorization is required for this endpoint. The response will include basic information about the prism and does not expose sensitive information.",
        "tags": [
          "Prisms"
        ],
        "parameters": [
          {
            "name": "prism_id",
            "in": "path",
            "description": "The unique identifier of the prism to retrieve.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "example": "1"
            }
          }
        ],
        "authorization_tag": "Authorization Not Required",
        "module_tag": "prisms",
        "sensitive_information": false,
        "responses": {
          "200": {
            "description": "Prism details retrieved successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "id": {
                      "type": "string",
                      "description": "The unique identifier of the prism.",
                      "example": "1"
                    },
                    "name": {
                      "type": "string",
                      "description": "The name of the prism.",
                      "example": "Prism 1"
                    },
                    "status": {
                      "type": "string",
                      "description": "The status of the prism.",
                      "example": "active"
                    }
                  },
                  "required": [
                    "id",
                    "name",
                    "status"
                  ]
                },
                "examples": {
                  "success": {
                    "summary": "Example response",
                    "value": {
                      "id": "1",
                      "name": "Prism 1",
                      "status": "active"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid prism_id supplied.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid prism_id"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Prism not found.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Prism not found"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete a Custom Prism",
        "api_description": "Deletes a custom prism identified by its unique prism_id. This endpoint is used to permanently remove a custom prism from the system. Only authorized users are allowed to perform this operation. The prism_id must be a valid string identifier representing an existing custom prism. If the prism does not exist or the user is not authorized, an appropriate error is returned.",
        "tags": [
          "Prisms"
        ],
        "parameters": [
          {
            "name": "prism_id",
            "in": "path",
            "description": "The unique identifier of the prism to be deleted.",
            "required": true,
            "schema": {
              "type": "string",
              "example": "123abc456def"
            }
          }
        ],
        "security": [
          {
            "bearerAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "prisms",
        "sensitive_information": true,
        "responses": {
          "200": {
            "description": "Prism deleted successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Prism 123abc456def deleted successfully"
                    }
                  },
                  "required": [
                    "message"
                  ]
                },
                "examples": {
                  "success": {
                    "summary": "Successful Deletion",
                    "value": {
                      "message": "Prism 123abc456def deleted successfully"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid prism_id supplied.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid prism_id"
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "examples": {
                  "invalid_id": {
                    "summary": "Invalid prism_id",
                    "value": {
                      "error": "Invalid prism_id"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication credentials were missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detail": {
                      "type": "string",
                      "example": "Not authenticated"
                    }
                  },
                  "required": [
                    "detail"
                  ]
                },
                "examples": {
                  "unauthorized": {
                    "summary": "Unauthorized",
                    "value": {
                      "detail": "Not authenticated"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. The user does not have permission to delete this prism.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detail": {
                      "type": "string",
                      "example": "You do not have permission to delete this prism"
                    }
                  },
                  "required": [
                    "detail"
                  ]
                },
                "examples": {
                  "forbidden": {
                    "summary": "Forbidden",
                    "value": {
                      "detail": "You do not have permission to delete this prism"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Prism not found.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Prism not found"
                    }
                  },
                  "required": [
                    "error"
                  ]
                },
                "examples": {
                  "not_found": {
                    "summary": "Not Found",
                    "value": {
                      "error": "Prism not found"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/prisms": {
      "get": {
        "summary": "List Available Prisms",
        "api_description": "Returns a list of available prisms. This endpoint provides a collection of all prisms currently accessible to the user. No query or path parameters are required. The response contains an array of prisms, each represented as an object with string key-value pairs for properties like id and name. This endpoint does not modify any data and is intended for informational listing only.",
        "tags": [
          "Prisms"
        ],
        "parameters": [],
        "authorization_tag": "Authorization Not Required",
        "module_tag": "prisms",
        "sensitive_information": false,
        "responses": {
          "200": {
            "description": "A list of available prisms.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "prisms": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "id": {
                            "type": "string",
                            "example": "1",
                            "description": "Unique identifier for the prism."
                          },
                          "name": {
                            "type": "string",
                            "example": "Default Prism",
                            "description": "Display name of the prism."
                          }
                        },
                        "required": [
                          "id",
                          "name"
                        ],
                        "additionalProperties": {
                          "type": "string"
                        }
                      },
                      "example": [
                        {
                          "id": "1",
                          "name": "Default Prism"
                        }
                      ]
                    }
                  },
                  "required": [
                    "prisms"
                  ]
                },
                "examples": {
                  "success": {
                    "summary": "Sample response",
                    "value": {
                      "prisms": [
                        {
                          "id": "1",
                          "name": "Default Prism"
                        }
                      ]
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad Request. The request was malformed.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detail": {
                      "type": "string",
                      "example": "Invalid request."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error. An unexpected error occurred.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detail": {
                      "type": "string",
                      "example": "An internal error occurred."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/db/:database/:collection/:document": {
      "put": {
        "summary": "Update a Document in a Collection",
        "api_description": "This endpoint updates (replaces) an existing document in a specified MongoDB collection within a given database. The document to update is identified by its unique _id (provided as a path parameter, possibly encoded). The request body must contain the full document to replace the existing one. The endpoint performs validation to ensure the document is not empty and is valid BSON/JSON. If the document is invalid or not found, appropriate error responses are returned. Authentication is required and may be enforced via Basic Auth or OIDC depending on configuration. CSRF protection is applied except in test environments. Only users with proper authorization can update documents. The operation is sensitive as it modifies database contents.",
        "tags": [
          "Databases"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "Name of the database containing the collection.",
            "required": true,
            "schema": {
              "type": "string",
              "example": "testdb"
            }
          },
          {
            "name": "collection",
            "in": "path",
            "description": "Name of the collection containing the document.",
            "required": true,
            "schema": {
              "type": "string",
              "example": "users"
            }
          },
          {
            "name": "document",
            "in": "path",
            "description": "Identifier of the document (_id). This may be a string or an encoded ObjectId.",
            "required": true,
            "schema": {
              "type": "string",
              "example": "\"5f2a1b2c3d4e5f6789012345\""
            }
          },
          {
            "name": "skip",
            "in": "query",
            "description": "Number of documents to skip when redirecting after update (for pagination). Optional.",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 0,
              "example": 0
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "document": {
                    "type": "object",
                    "description": "The full document to replace the existing one. Must include the _id field matching the document path parameter.",
                    "example": {
                      "_id": "5f2a1b2c3d4e5f6789012345",
                      "name": "John Doe",
                      "email": "john@example.com",
                      "role": "admin"
                    }
                  }
                },
                "required": [
                  "document"
                ]
              }
            }
          }
        },
        "security": [
          {
            "basicAuth": [],
            "oidcAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "databases",
        "sensitive_information": true,
        "responses": {
          "200": {
            "description": "Document updated successfully. Redirects to the collection or document view.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Document updated!"
                    },
                    "redirectUrl": {
                      "type": "string",
                      "description": "URL to which the client should redirect after update.",
                      "example": "/db/testdb/users"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid input: e.g., missing or invalid document in request body.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "You forgot to enter a document!"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized: Authentication credentials are missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden: User does not have permission to update this document.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Access denied"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found: The specified document does not exist.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Document not found!"
                    }
                  }
                }
              }
            }
          },
          "422": {
            "description": "Unprocessable Entity: The provided document is not valid BSON/JSON.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "That document is not valid!"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error: Unexpected error during update.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Something went wrong: <error details>"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "get": {
        "summary": "Retrieve a Single Document from a Collection",
        "api_description": "This endpoint retrieves a single document from a specific MongoDB collection within a database. The endpoint requires the client to specify the database name, collection name, and a document identifier (ID). The document ID must be a valid MongoDB ObjectId, a valid Binary ID (with supported subtypes), or a raw string ID. The endpoint supports authentication and CSRF protection, and will only return the document if found. If the collection or document does not exist, an error or redirection occurs. The endpoint may also require HTTP Basic Auth or OpenID Connect authentication, depending on server configuration. Query parameters can be used to specify ID subtype where needed.",
        "tags": [
          "Documents"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "required": true,
            "description": "Name of the MongoDB database.",
            "schema": {
              "type": "string",
              "example": "sampledb"
            }
          },
          {
            "name": "collection",
            "in": "path",
            "required": true,
            "description": "Name of the collection within the database.",
            "schema": {
              "type": "string",
              "example": "users"
            }
          },
          {
            "name": "document",
            "in": "path",
            "required": true,
            "description": "Document identifier. Must be a valid ObjectId (24 hex chars), a valid Binary ID (with supported subtypes), or a raw string ID. If passing a Binary ID, use the 'subtype' query parameter.",
            "schema": {
              "type": "string",
              "example": "64f8c7a3b7e1a2d8e6e5f4c3"
            }
          },
          {
            "name": "subtype",
            "in": "query",
            "required": false,
            "description": "Binary subtype (integer, only for Binary IDs). Supported: 3 (UUID_OLD), 4 (UUID).",
            "schema": {
              "type": "integer",
              "enum": [
                3,
                4
              ],
              "example": 4
            }
          }
        ],
        "security": [
          {
            "basicAuth": []
          },
          {
            "oidcAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "documents",
        "sensitive_information": true,
        "responses": {
          "200": {
            "description": "Document retrieved successfully.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "description": "The full MongoDB document object.",
                  "properties": {
                    "_id": {
                      "type": [
                        "string",
                        "object"
                      ],
                      "description": "The document's unique identifier (ObjectId, Binary, or string).",
                      "example": "64f8c7a3b7e1a2d8e6e5f4c3"
                    },
                    "name": {
                      "type": "string",
                      "example": "Alice"
                    },
                    "email": {
                      "type": "string",
                      "example": "alice@example.com"
                    },
                    "createdAt": {
                      "type": "string",
                      "format": "date-time",
                      "example": "2024-06-12T14:23:54.123Z"
                    },
                    "profile": {
                      "type": "object",
                      "properties": {
                        "age": {
                          "type": "integer",
                          "example": 30
                        },
                        "active": {
                          "type": "boolean",
                          "example": true
                        }
                      }
                    }
                  },
                  "example": {
                    "_id": "64f8c7a3b7e1a2d8e6e5f4c3",
                    "name": "Alice",
                    "email": "alice@example.com",
                    "createdAt": "2024-06-12T14:23:54.123Z",
                    "profile": {
                      "age": 30,
                      "active": true
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request. Invalid parameters or document ID.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Document lacks an _id!"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication required or failed.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. CSRF token missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid CSRF token"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not found. Collection or document does not exist.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Document not found!"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Error: <error details>"
                    }
                  }
                }
              }
            }
          }
        }
      },
      "delete": {
        "summary": "Delete a Document from a Collection",
        "api_description": "Deletes a specific document from a given collection in a database. If the document parameter is provided, only the targeted document will be deleted. This endpoint supports additional query parameters for advanced filtering, but if not provided, the document identified by the path parameter will be deleted. The operation is blocked if the system is in read-only mode or if deletions are globally disabled (via configuration). Requires session-based authentication (either Basic Auth or OIDC, depending on configuration). Only authenticated users can access this endpoint. The endpoint requires CSRF protection via the 'x-csrf-token' header or CSRF cookie. All path parameters must be valid MongoDB names and document IDs. Query parameters allow for advanced deletion use-cases but are optional.",
        "tags": [
          "Databases"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "The name of the database containing the collection.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 63,
              "pattern": "^[^/\\. \"$*<>:|?]+$"
            },
            "example": "mydb"
          },
          {
            "name": "collection",
            "in": "path",
            "description": "The name of the collection containing the document.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1,
              "maxLength": 120,
              "pattern": "^[^/\\. \"$*<>:|?]+$"
            },
            "example": "users"
          },
          {
            "name": "document",
            "in": "path",
            "description": "The unique identifier (_id) of the document to delete. Accepts MongoDB ObjectId (hex string), UUID, or raw string ID.",
            "required": true,
            "schema": {
              "type": "string",
              "minLength": 1
            },
            "example": "64bb1c2fa1e4e2a3d6c1a5f0"
          },
          {
            "name": "skip",
            "in": "query",
            "description": "Number of documents to skip (for pagination). Optional.",
            "required": false,
            "schema": {
              "type": "integer",
              "minimum": 0
            },
            "example": 0
          },
          {
            "name": "key",
            "in": "query",
            "description": "Key to filter documents for advanced deletion. Optional.",
            "required": false,
            "schema": {
              "type": "string"
            },
            "example": "status"
          },
          {
            "name": "value",
            "in": "query",
            "description": "Value to filter documents for advanced deletion. Optional.",
            "required": false,
            "schema": {
              "type": "string"
            },
            "example": "inactive"
          },
          {
            "name": "type",
            "in": "query",
            "description": "Type of filter to use for deletion (e.g., exact, regex). Optional.",
            "required": false,
            "schema": {
              "type": "string"
            },
            "example": "exact"
          },
          {
            "name": "query",
            "in": "query",
            "description": "A JSON-encoded MongoDB query for deleting multiple documents. If present, deletes all documents matching the query instead of only the one specified in the path.",
            "required": false,
            "schema": {
              "type": "string"
            },
            "example": "{\"status\": \"inactive\"}"
          },
          {
            "name": "projection",
            "in": "query",
            "description": "A JSON-encoded MongoDB projection for advanced document selection. Optional.",
            "required": false,
            "schema": {
              "type": "string"
            },
            "example": "{\"_id\": 1}"
          },
          {
            "name": "x-csrf-token",
            "in": "header",
            "description": "CSRF token required for request validation.",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "a1b2c3d4e5"
          },
          {
            "name": "Authorization",
            "in": "header",
            "description": "HTTP Basic authentication header or Bearer token (if OIDC is enabled). Required unless the application is configured for open access.",
            "required": true,
            "schema": {
              "type": "string"
            },
            "example": "Basic YWRtaW46cGFzcw=="
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "databases",
        "sensitive_information": true,
        "responses": {
          "200": {
            "description": "Document deleted successfully, or multiple documents deleted if query is provided.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": true
                    },
                    "message": {
                      "type": "string",
                      "example": "Document deleted! _id: 64bb1c2fa1e4e2a3d6c1a5f0"
                    },
                    "deletedCount": {
                      "type": "integer",
                      "description": "Number of documents deleted (1 for single, >1 if query used).",
                      "example": 1
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request. Possible reasons: invalid database/collection/document name, missing parameters, invalid query/projection, or document not found.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": false
                    },
                    "error": {
                      "type": "string",
                      "example": "You forgot to enter a document!"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Missing or invalid authentication credentials.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": false
                    },
                    "error": {
                      "type": "string",
                      "example": "Authentication required."
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. Deletion is not allowed due to read-only mode or config.options.noDelete being true.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": false
                    },
                    "error": {
                      "type": "string",
                      "example": "Error: config.options.readOnly is set to true"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Document not found.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": false
                    },
                    "error": {
                      "type": "string",
                      "example": "Document not found."
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error. Unexpected error occurred during deletion.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean",
                      "example": false
                    },
                    "error": {
                      "type": "string",
                      "example": "Something went wrong: <error details>"
                    }
                  }
                }
              }
            }
          }
        },
        "examples": {
          "request": {
            "path": "/db/mydb/users/64bb1c2fa1e4e2a3d6c1a5f0",
            "method": "DELETE",
            "headers": {
              "Authorization": "Basic YWRtaW46cGFzcw==",
              "x-csrf-token": "a1b2c3d4e5"
            }
          },
          "request_with_query": {
            "path": "/db/mydb/users/any",
            "method": "DELETE",
            "headers": {
              "Authorization": "Basic YWRtaW46cGFzcw==",
              "x-csrf-token": "a1b2c3d4e5"
            },
            "query": {
              "query": "{\"status\": \"inactive\"}"
            }
          },
          "response_single_delete": {
            "status": 200,
            "body": {
              "success": true,
              "message": "Document deleted! _id: 64bb1c2fa1e4e2a3d6c1a5f0",
              "deletedCount": 1
            }
          },
          "response_multiple_delete": {
            "status": 200,
            "body": {
              "success": true,
              "message": "3 documents deleted from \"users\"",
              "deletedCount": 3
            }
          },
          "response_error": {
            "status": 400,
            "body": {
              "success": false,
              "error": "You forgot to enter a document!"
            }
          }
        }
      }
    },
    "/db/:database/:collection/:document/:prop": {
      "get": {
        "summary": "Get a Single Property from a Document",
        "api_description": "Retrieves the value of a specified property from a document within a collection in a MongoDB database. The endpoint is designed for efficient, asynchronous retrieval of large property values, such as binary data or large text fields, without loading the entire document. All path parameters must be valid and exist: the database, collection, and document must exist, and the document must have a valid _id. If the collection or document is not found, an error is returned or a redirect occurs. The 'document' parameter is expected to be a URI-encoded JSON string representing the _id, which may be a string, an ObjectId, or a Binary ID (with optional 'subtype' query parameter). Authorization is required via either Basic Auth or OIDC, depending on server configuration. CSRF protection is in place for modifying requests, but GET is always allowed. This endpoint may expose sensitive information contained in the document property.",
        "tags": [
          "Databases"
        ],
        "parameters": [
          {
            "name": "database",
            "in": "path",
            "description": "The name of the database to query.",
            "required": true,
            "schema": {
              "type": "string",
              "example": "myDatabase"
            }
          },
          {
            "name": "collection",
            "in": "path",
            "description": "The name of the collection within the database.",
            "required": true,
            "schema": {
              "type": "string",
              "example": "users"
            }
          },
          {
            "name": "document",
            "in": "path",
            "description": "The URI-encoded JSON string representing the document's _id. Can be a string, ObjectId, or BinaryId. Example: \"%7B%22_id%22%3A%221234567890abcdef12345678%22%7D\" or a simple string.",
            "required": true,
            "schema": {
              "type": "string",
              "example": "%221234567890abcdef12345678%22"
            }
          },
          {
            "name": "prop",
            "in": "path",
            "description": "The property name to retrieve from the document.",
            "required": true,
            "schema": {
              "type": "string",
              "example": "profilePicture"
            }
          },
          {
            "name": "subtype",
            "in": "query",
            "description": "Optional. If the document _id is a Binary ID, specify the MongoDB binary subtype (integer, e.g., 3 or 4).",
            "required": false,
            "schema": {
              "type": "integer",
              "example": 4,
              "enum": [
                3,
                4
              ]
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "description": "Required if Basic Auth or OIDC is enabled. For Basic Auth, use 'Basic base64encoded(username:password)'. For OIDC, use the Bearer access_token as per server configuration.",
            "required": true,
            "schema": {
              "type": "string",
              "example": "Basic YWRtaW46cGFzcw=="
            }
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "db",
        "sensitive_information": true,
        "responses": {
          "200": {
            "description": "Property value retrieved successfully. The response type depends on the property; for binary data, the appropriate content-type is set.",
            "content": {
              "application/json": {
                "schema": {
                  "oneOf": [
                    {
                      "type": "string",
                      "description": "Property value as a string.",
                      "example": "John Doe"
                    },
                    {
                      "type": "number",
                      "description": "Property value as a number.",
                      "example": 42
                    },
                    {
                      "type": "boolean",
                      "description": "Property value as a boolean.",
                      "example": true
                    },
                    {
                      "type": "object",
                      "description": "Property value as an object.",
                      "example": {
                        "street": "123 Main St",
                        "city": "Metropolis"
                      }
                    },
                    {
                      "type": "array",
                      "description": "Property value as an array.",
                      "example": [
                        1,
                        2,
                        3
                      ]
                    }
                  ]
                }
              },
              "application/octet-stream": {
                "schema": {
                  "type": "string",
                  "format": "binary",
                  "description": "Binary property value, e.g., image or file."
                }
              }
            }
          },
          "400": {
            "description": "Bad Request. Invalid or missing path parameters, or invalid document _id.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Document lacks an _id!"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized. Authentication is required and has failed or has not yet been provided.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required."
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden. The authenticated user does not have access to the requested resource.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Access denied."
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Not Found. The database, collection, document, or property does not exist.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Document not found!"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error. An error occurred while processing the request.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Error: <error details>"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/prisms/custom": {
      "post": {
        "summary": "Create a Custom Prism",
        "api_description": "This endpoint creates a new custom prism. It is intended for users to define and register a new prism resource in the system. The endpoint does not require any request body parameters for this placeholder implementation, but in a real-world scenario, you would likely provide prism details (such as name, configuration, etc.). The endpoint returns a message indicating successful creation. No path or query parameters are required. This endpoint is protected and requires user authentication (for example, via session, CSRF token, or other mechanisms).",
        "tags": [
          "Prisms"
        ],
        "requestBody": {
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "description": "No request body is required for this placeholder implementation. In a full implementation, this would include the new prism's configuration."
              },
              "example": {}
            }
          }
        },
        "parameters": [
          {
            "name": "X-CSRF-Token",
            "in": "header",
            "description": "CSRF token to protect against cross-site request forgery. Required unless in test mode.",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Cookie",
            "in": "header",
            "description": "Session cookie for user authentication.",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "Authorization",
            "in": "header",
            "description": "Bearer token or Basic Auth credentials if enabled in configuration.",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "prisms",
        "sensitive_information": false,
        "responses": {
          "200": {
            "description": "Custom prism created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Custom prism created successfully",
                      "description": "A message indicating the prism was created."
                    }
                  },
                  "required": [
                    "message"
                  ],
                  "example": {
                    "message": "Custom prism created successfully"
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - Invalid input or missing required parameters.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detail": {
                      "type": "string",
                      "example": "Invalid prism data"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Authentication credentials were missing or invalid.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detail": {
                      "type": "string",
                      "example": "Not authenticated"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - The user does not have permission to perform this action.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "detail": {
                      "type": "string",
                      "example": "You do not have permission to create a custom prism"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/llm/session-title": {
      "post": {
        "summary": "Generate LLM Session Title",
        "api_description": "This endpoint generates a title for an LLM (Large Language Model) session. It does not require any request body parameters. The endpoint is typically used to provide an automated, descriptive title for a new or ongoing LLM session. There are no query or path parameters. The endpoint is protected and requires the user to be authenticated, typically via session, OIDC, or basic authentication as configured in the hosting application. The response will contain a generated session title as a string.",
        "tags": [
          "Llms"
        ],
        "requestBody": {
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "description": "No request body parameters are required for this endpoint."
              },
              "example": {}
            }
          }
        },
        "parameters": [],
        "security": [
          {
            "cookieAuth": [],
            "basicAuth": [],
            "oidcAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "llm",
        "sensitive_information": false,
        "responses": {
          "200": {
            "description": "Session title generated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "title": {
                      "type": "string",
                      "description": "The generated session title.",
                      "example": "Generated Session Title"
                    }
                  },
                  "required": [
                    "title"
                  ]
                },
                "example": {
                  "title": "Generated Session Title"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request - The request was malformed or missing required data.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid request"
                    }
                  }
                },
                "example": {
                  "error": "Invalid request"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - Authentication is required and has failed or has not yet been provided.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required"
                    }
                  }
                },
                "example": {
                  "error": "Authentication required"
                }
              }
            }
          },
          "500": {
            "description": "Internal Server Error - An unexpected error occurred on the server.",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Internal server error"
                    }
                  }
                },
                "example": {
                  "error": "Internal server error"
                }
              }
            }
          }
        }
      }
    },
    "/api/prisms/{prism_id}/set-default": {
      "post": {
        "summary": "Set Default Prism",
        "api_description": "This endpoint sets the specified prism as the default prism for the current authenticated user. The 'prism_id' path parameter is required and must be a valid string identifier for an existing prism. The endpoint requires authentication and will only succeed if the user has permission to set the default prism. No request body is required. If the prism is set successfully, a success message is returned. Errors are returned for missing or invalid prism_id, unauthorized access, or if the prism cannot be set as default.",
        "tags": [
          "Prisms"
        ],
        "parameters": [
          {
            "name": "prism_id",
            "in": "path",
            "description": "The unique identifier of the prism to set as default.",
            "required": true,
            "schema": {
              "type": "string",
              "example": "12345"
            }
          }
        ],
        "requestBody": {
          "required": false,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "description": "No request body is required for this endpoint."
              }
            }
          }
        },
        "security": [
          {
            "cookieAuth": [],
            "sessionAuth": []
          }
        ],
        "authorization_tag": "Authorization Required",
        "module_tag": "prisms",
        "sensitive_information": false,
        "responses": {
          "200": {
            "description": "Prism set as default successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string",
                      "example": "Prism 12345 set as default"
                    }
                  }
                },
                "examples": {
                  "success": {
                    "value": {
                      "message": "Prism 12345 set as default"
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid request or missing/invalid prism_id",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Invalid prism_id"
                    }
                  }
                },
                "examples": {
                  "invalid_prism_id": {
                    "value": {
                      "error": "Invalid prism_id"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized - authentication required or session expired",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Authentication required"
                    }
                  }
                },
                "examples": {
                  "unauthorized": {
                    "value": {
                      "error": "Authentication required"
                    }
                  }
                }
              }
            }
          },
          "403": {
            "description": "Forbidden - user does not have permission to set this prism as default",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "You do not have permission to set this prism as default"
                    }
                  }
                },
                "examples": {
                  "forbidden": {
                    "value": {
                      "error": "You do not have permission to set this prism as default"
                    }
                  }
                }
              }
            }
          },
          "404": {
            "description": "Prism not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "error": {
                      "type": "string",
                      "example": "Prism not found"
                    }
                  }
                },
                "examples": {
                  "not_found": {
                    "value": {
                      "error": "Prism not found"
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
}